(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();const ve={};function Gi(e){ve.context=e}const Qi=(e,t)=>e===t,Jn=Symbol("solid-proxy"),Ji=Symbol("solid-track"),qt={equals:Qi};let Yr=ei;const Oe=1,Yt=2,Xr={owned:null,cleanups:null,context:null,owner:null};var W=null;let Ne=null,z=null,ee=null,_e=null,Zn=0;function lt(e,t){const n=z,r=W,i=e.length===0,o=i?Xr:{owned:null,cleanups:null,context:null,owner:t||r},s=i?e:()=>e(()=>fe(()=>rr(o)));W=o,z=null;try{return He(s,!0)}finally{z=n,W=r}}function G(e,t){t=t?Object.assign({},qt,t):qt;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},r=i=>(typeof i=="function"&&(i=i(n.value)),Zr(n,i));return[Jr.bind(n),r]}function oe(e,t,n){const r=nr(e,t,!1,Oe);Et(r)}function Zi(e,t,n){Yr=oo;const r=nr(e,t,!1,Oe);r.user=!0,_e?_e.push(r):Et(r)}function F(e,t,n){n=n?Object.assign({},qt,n):qt;const r=nr(e,t,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,Et(r),Jr.bind(r)}function fe(e){const t=z;z=null;try{return e()}finally{z=t}}function Gr(e,t,n){const r=Array.isArray(e);let i,o=n&&n.defer;return s=>{let a;if(r){a=Array(e.length);for(let l=0;l<e.length;l++)a[l]=e[l]()}else a=e();if(o){o=!1;return}const u=fe(()=>t(a,i,s));return i=a,u}}function St(e){return W===null||(W.cleanups===null?W.cleanups=[e]:W.cleanups.push(e)),e}function eo(){return W}function to(e,t){const n=W;W=e;try{return He(t,!0)}finally{W=n}}function no(e){const t=z,n=W;return Promise.resolve().then(()=>{z=t,W=n;let r;return He(e,!1),z=W=null,r?r.done:void 0})}function Qr(e,t){const n=Symbol("context");return{id:n,Provider:ao(n),defaultValue:e}}function er(e){let t;return(t=ri(W,e.id))!==void 0?t:e.defaultValue}function tr(e){const t=F(e),n=F(()=>Sn(t()));return n.toArray=()=>{const r=n();return Array.isArray(r)?r:r!=null?[r]:[]},n}function Jr(){const e=Ne;if(this.sources&&(this.state||e))if(this.state===Oe||e)Et(this);else{const t=ee;ee=null,He(()=>Gt(this),!1),ee=t}if(z){const t=this.observers?this.observers.length:0;z.sources?(z.sources.push(this),z.sourceSlots.push(t)):(z.sources=[this],z.sourceSlots=[t]),this.observers?(this.observers.push(z),this.observerSlots.push(z.sources.length-1)):(this.observers=[z],this.observerSlots=[z.sources.length-1])}return this.value}function Zr(e,t,n){let r=e.value;return(!e.comparator||!e.comparator(r,t))&&(e.value=t,e.observers&&e.observers.length&&He(()=>{for(let i=0;i<e.observers.length;i+=1){const o=e.observers[i],s=Ne&&Ne.running;s&&Ne.disposed.has(o),(s&&!o.tState||!s&&!o.state)&&(o.pure?ee.push(o):_e.push(o),o.observers&&ti(o)),s||(o.state=Oe)}if(ee.length>1e6)throw ee=[],new Error},!1)),t}function Et(e){if(!e.fn)return;rr(e);const t=W,n=z,r=Zn;z=W=e,ro(e,e.value,r),z=n,W=t}function ro(e,t,n){let r;try{r=e.fn(t)}catch(i){e.pure&&(e.state=Oe),ni(i)}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?Zr(e,r):e.value=r,e.updatedAt=n)}function nr(e,t,n,r=Oe,i){const o={fn:e,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:W,context:null,pure:n};return W===null||W!==Xr&&(W.owned?W.owned.push(o):W.owned=[o]),o}function Xt(e){const t=Ne;if(e.state===0||t)return;if(e.state===Yt||t)return Gt(e);if(e.suspense&&fe(e.suspense.inFallback))return e.suspense.effects.push(e);const n=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<Zn);)(e.state||t)&&n.push(e);for(let r=n.length-1;r>=0;r--)if(e=n[r],e.state===Oe||t)Et(e);else if(e.state===Yt||t){const i=ee;ee=null,He(()=>Gt(e,n[0]),!1),ee=i}}function He(e,t){if(ee)return e();let n=!1;t||(ee=[]),_e?n=!0:_e=[],Zn++;try{const r=e();return io(n),r}catch(r){ee||(_e=null),ni(r)}}function io(e){if(ee&&(ei(ee),ee=null),e)return;const t=_e;_e=null,t.length&&He(()=>Yr(t),!1)}function ei(e){for(let t=0;t<e.length;t++)Xt(e[t])}function oo(e){let t,n=0;for(t=0;t<e.length;t++){const r=e[t];r.user?e[n++]=r:Xt(r)}for(ve.context&&Gi(),t=0;t<n;t++)Xt(e[t])}function Gt(e,t){const n=Ne;e.state=0;for(let r=0;r<e.sources.length;r+=1){const i=e.sources[r];i.sources&&(i.state===Oe||n?i!==t&&Xt(i):(i.state===Yt||n)&&Gt(i,t))}}function ti(e){const t=Ne;for(let n=0;n<e.observers.length;n+=1){const r=e.observers[n];(!r.state||t)&&(r.state=Yt,r.pure?ee.push(r):_e.push(r),r.observers&&ti(r))}}function rr(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),r=e.sourceSlots.pop(),i=n.observers;if(i&&i.length){const o=i.pop(),s=n.observerSlots.pop();r<i.length&&(o.sourceSlots[s]=r,i[r]=o,n.observerSlots[r]=s)}}if(e.owned){for(t=0;t<e.owned.length;t++)rr(e.owned[t]);e.owned=null}if(e.cleanups){for(t=0;t<e.cleanups.length;t++)e.cleanups[t]();e.cleanups=null}e.state=0,e.context=null}function so(e){return e instanceof Error||typeof e=="string"?e:new Error("Unknown error")}function ni(e){throw e=so(e),e}function ri(e,t){return e?e.context&&e.context[t]!==void 0?e.context[t]:ri(e.owner,t):void 0}function Sn(e){if(typeof e=="function"&&!e.length)return Sn(e());if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;n++){const r=Sn(e[n]);Array.isArray(r)?t.push.apply(t,r):t.push(r)}return t}return e}function ao(e,t){return function(r){let i;return oe(()=>i=fe(()=>(W.context={[e]:r.value},tr(()=>r.children))),void 0),i}}const uo=Symbol("fallback");function Sr(e){for(let t=0;t<e.length;t++)e[t]()}function lo(e,t,n={}){let r=[],i=[],o=[],s=0,a=t.length>1?[]:null;return St(()=>Sr(o)),()=>{let u=e()||[],l,c;return u[Ji],fe(()=>{let d=u.length,_,p,y,S,v,h,g,w,m;if(d===0)s!==0&&(Sr(o),o=[],r=[],i=[],s=0,a&&(a=[])),n.fallback&&(r=[uo],i[0]=lt(b=>(o[0]=b,n.fallback())),s=1);else if(s===0){for(i=new Array(d),c=0;c<d;c++)r[c]=u[c],i[c]=lt(f);s=d}else{for(y=new Array(d),S=new Array(d),a&&(v=new Array(d)),h=0,g=Math.min(s,d);h<g&&r[h]===u[h];h++);for(g=s-1,w=d-1;g>=h&&w>=h&&r[g]===u[w];g--,w--)y[w]=i[g],S[w]=o[g],a&&(v[w]=a[g]);for(_=new Map,p=new Array(w+1),c=w;c>=h;c--)m=u[c],l=_.get(m),p[c]=l===void 0?-1:l,_.set(m,c);for(l=h;l<=g;l++)m=r[l],c=_.get(m),c!==void 0&&c!==-1?(y[c]=i[l],S[c]=o[l],a&&(v[c]=a[l]),c=p[c],_.set(m,c)):o[l]();for(c=h;c<d;c++)c in y?(i[c]=y[c],o[c]=S[c],a&&(a[c]=v[c],a[c](c))):i[c]=lt(f);i=i.slice(0,s=d),r=u.slice(0)}return i});function f(d){if(o[c]=d,a){const[_,p]=G(c);return a[c]=p,t(u[c],_)}return t(u[c])}}}function R(e,t){return fe(()=>e(t||{}))}function $t(){return!0}const ii={get(e,t,n){return t===Jn?n:e.get(t)},has(e,t){return e.has(t)},set:$t,deleteProperty:$t,getOwnPropertyDescriptor(e,t){return{configurable:!0,enumerable:!0,get(){return e.get(t)},set:$t,deleteProperty:$t}},ownKeys(e){return e.keys()}};function vn(e){return(e=typeof e=="function"?e():e)?e:{}}function En(...e){if(e.some(n=>n&&(Jn in n||typeof n=="function")))return new Proxy({get(n){for(let r=e.length-1;r>=0;r--){const i=vn(e[r])[n];if(i!==void 0)return i}},has(n){for(let r=e.length-1;r>=0;r--)if(n in vn(e[r]))return!0;return!1},keys(){const n=[];for(let r=0;r<e.length;r++)n.push(...Object.keys(vn(e[r])));return[...new Set(n)]}},ii);const t={};for(let n=e.length-1;n>=0;n--)if(e[n]){const r=Object.getOwnPropertyDescriptors(e[n]);for(const i in r)i in t||Object.defineProperty(t,i,{enumerable:!0,get(){for(let o=e.length-1;o>=0;o--){const s=(e[o]||{})[i];if(s!==void 0)return s}}})}return t}function co(e,...t){const n=new Set(t.flat()),r=Object.getOwnPropertyDescriptors(e),i=Jn in e;i||t.push(Object.keys(r).filter(s=>!n.has(s)));const o=t.map(s=>{const a={};for(let u=0;u<s.length;u++){const l=s[u];!i&&!(l in e)||Object.defineProperty(a,l,r[l]?r[l]:{get(){return e[l]},set(){return!0},enumerable:!0})}return a});return i&&o.push(new Proxy({get(s){return n.has(s)?void 0:e[s]},has(s){return n.has(s)?!1:s in e},keys(){return Object.keys(e).filter(s=>!n.has(s))}},ii)),o}function ir(e){const t="fallback"in e&&{fallback:()=>e.fallback};return F(lo(()=>e.each,e.children,t||void 0))}function ue(e){let t=!1;const n=e.keyed,r=F(()=>e.when,void 0,{equals:(i,o)=>t?i===o:!i==!o});return F(()=>{const i=r();if(i){const o=e.children,s=typeof o=="function"&&o.length>0;return t=n||s,s?fe(()=>o(i)):o}return e.fallback})}const fo=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],ho=new Set(["className","value","readOnly","formNoValidate","isMap","noModule","playsInline",...fo]),po=new Set(["innerHTML","textContent","innerText","children"]),vo=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),Er=Object.assign(Object.create(null),{class:"className",formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly"}),yo=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),mo={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"};function go(e,t,n){let r=n.length,i=t.length,o=r,s=0,a=0,u=t[i-1].nextSibling,l=null;for(;s<i||a<o;){if(t[s]===n[a]){s++,a++;continue}for(;t[i-1]===n[o-1];)i--,o--;if(i===s){const c=o<r?a?n[a-1].nextSibling:n[o-a]:u;for(;a<o;)e.insertBefore(n[a++],c)}else if(o===a)for(;s<i;)(!l||!l.has(t[s]))&&t[s].remove(),s++;else if(t[s]===n[o-1]&&n[a]===t[i-1]){const c=t[--i].nextSibling;e.insertBefore(n[a++],t[s++].nextSibling),e.insertBefore(n[--o],c),t[i]=n[o]}else{if(!l){l=new Map;let f=a;for(;f<o;)l.set(n[f],f++)}const c=l.get(t[s]);if(c!=null)if(a<c&&c<o){let f=s,d=1,_;for(;++f<i&&f<o&&!((_=l.get(t[f]))==null||_!==c+d);)d++;if(d>c-a){const p=t[s];for(;a<c;)e.insertBefore(n[a++],p)}else e.replaceChild(n[a++],t[s++])}else s++;else t[s++].remove()}}}const Cr="_$DX_DELEGATE";function wo(e,t,n,r={}){let i;return lt(o=>{i=o,t===document?e():B(t,e(),t.firstChild?null:void 0,n)},r.owner),()=>{i(),t.textContent=""}}function q(e,t,n){const r=document.createElement("template");r.innerHTML=e;let i=r.content.firstChild;return n&&(i=i.firstChild),i}function ze(e,t=window.document){const n=t[Cr]||(t[Cr]=new Set);for(let r=0,i=e.length;r<i;r++){const o=e[r];n.has(o)||(n.add(o),t.addEventListener(o,ko))}}function he(e,t,n){n==null?e.removeAttribute(t):e.setAttribute(t,n)}function bo(e,t,n,r){r==null?e.removeAttributeNS(t,n):e.setAttributeNS(t,n,r)}function _o(e,t){t==null?e.removeAttribute("class"):e.className=t}function oi(e,t,n,r){if(r)Array.isArray(n)?(e[`$$${t}`]=n[0],e[`$$${t}Data`]=n[1]):e[`$$${t}`]=n;else if(Array.isArray(n)){const i=n[0];e.addEventListener(t,n[0]=o=>i.call(e,n[1],o))}else e.addEventListener(t,n)}function xo(e,t,n={}){const r=Object.keys(t||{}),i=Object.keys(n);let o,s;for(o=0,s=i.length;o<s;o++){const a=i[o];!a||a==="undefined"||t[a]||(Ar(e,a,!1),delete n[a])}for(o=0,s=r.length;o<s;o++){const a=r[o],u=!!t[a];!a||a==="undefined"||n[a]===u||!u||(Ar(e,a,!0),n[a]=u)}return n}function So(e,t,n){if(!t)return n?he(e,"style"):t;const r=e.style;if(typeof t=="string")return r.cssText=t;typeof n=="string"&&(r.cssText=n=void 0),n||(n={}),t||(t={});let i,o;for(o in n)t[o]==null&&r.removeProperty(o),delete n[o];for(o in t)i=t[o],i!==n[o]&&(r.setProperty(o,i),n[o]=i);return n}function Eo(e,t={},n,r){const i={};return r||oe(()=>i.children=et(e,t.children,i.children)),oe(()=>t.ref&&t.ref(e)),oe(()=>Co(e,t,n,!0,i,!0)),i}function Fe(e,t,n){return fe(()=>e(t,n))}function B(e,t,n,r){if(n!==void 0&&!r&&(r=[]),typeof t!="function")return et(e,t,r,n);oe(i=>et(e,t(),i,n),r)}function Co(e,t,n,r,i={},o=!1){t||(t={});for(const s in i)if(!(s in t)){if(s==="children")continue;i[s]=kr(e,s,null,i[s],n,o)}for(const s in t){if(s==="children"){r||et(e,t.children);continue}const a=t[s];i[s]=kr(e,s,a,i[s],n,o)}}function Ao(e){return e.toLowerCase().replace(/-([a-z])/g,(t,n)=>n.toUpperCase())}function Ar(e,t,n){const r=t.trim().split(/\s+/);for(let i=0,o=r.length;i<o;i++)e.classList.toggle(r[i],n)}function kr(e,t,n,r,i,o){let s,a,u;if(t==="style")return So(e,n,r);if(t==="classList")return xo(e,n,r);if(n===r)return r;if(t==="ref")o||n(e);else if(t.slice(0,3)==="on:"){const l=t.slice(3);r&&e.removeEventListener(l,r),n&&e.addEventListener(l,n)}else if(t.slice(0,10)==="oncapture:"){const l=t.slice(10);r&&e.removeEventListener(l,r,!0),n&&e.addEventListener(l,n,!0)}else if(t.slice(0,2)==="on"){const l=t.slice(2).toLowerCase(),c=yo.has(l);if(!c&&r){const f=Array.isArray(r)?r[0]:r;e.removeEventListener(l,f)}(c||n)&&(oi(e,l,n,c),c&&ze([l]))}else if((u=po.has(t))||!i&&(Er[t]||(a=ho.has(t)))||(s=e.nodeName.includes("-")))t==="class"||t==="className"?_o(e,n):s&&!a&&!u?e[Ao(t)]=n:e[Er[t]||t]=n;else{const l=i&&t.indexOf(":")>-1&&mo[t.split(":")[0]];l?bo(e,l,t,n):he(e,vo[t]||t,n)}return n}function ko(e){const t=`$$${e.type}`;let n=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==n&&Object.defineProperty(e,"target",{configurable:!0,value:n}),Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return n||document}}),ve.registry&&!ve.done&&(ve.done=!0,document.querySelectorAll("[id^=pl-]").forEach(r=>r.remove()));n!==null;){const r=n[t];if(r&&!n.disabled){const i=n[`${t}Data`];if(i!==void 0?r.call(n,i,e):r.call(n,e),e.cancelBubble)return}n=n.host&&n.host!==n&&n.host instanceof Node?n.host:n.parentNode}}function et(e,t,n,r,i){for(ve.context&&!n&&(n=[...e.childNodes]);typeof n=="function";)n=n();if(t===n)return n;const o=typeof t,s=r!==void 0;if(e=s&&n[0]&&n[0].parentNode||e,o==="string"||o==="number"){if(ve.context)return n;if(o==="number"&&(t=t.toString()),s){let a=n[0];a&&a.nodeType===3?a.data=t:a=document.createTextNode(t),n=Ye(e,n,r,a)}else n!==""&&typeof n=="string"?n=e.firstChild.data=t:n=e.textContent=t}else if(t==null||o==="boolean"){if(ve.context)return n;n=Ye(e,n,r)}else{if(o==="function")return oe(()=>{let a=t();for(;typeof a=="function";)a=a();n=et(e,a,n,r)}),()=>n;if(Array.isArray(t)){const a=[],u=n&&Array.isArray(n);if(Cn(a,t,n,i))return oe(()=>n=et(e,a,n,r,!0)),()=>n;if(ve.context){if(!a.length)return n;for(let l=0;l<a.length;l++)if(a[l].parentNode)return n=a}if(a.length===0){if(n=Ye(e,n,r),s)return n}else u?n.length===0?Ir(e,a,r):go(e,n,a):(n&&Ye(e),Ir(e,a));n=a}else if(t instanceof Node){if(ve.context&&t.parentNode)return n=s?[t]:t;if(Array.isArray(n)){if(s)return n=Ye(e,n,r,t);Ye(e,n,null,t)}else n==null||n===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}}return n}function Cn(e,t,n,r){let i=!1;for(let o=0,s=t.length;o<s;o++){let a=t[o],u=n&&n[o];if(a instanceof Node)e.push(a);else if(!(a==null||a===!0||a===!1))if(Array.isArray(a))i=Cn(e,a,u)||i;else if(typeof a=="function")if(r){for(;typeof a=="function";)a=a();i=Cn(e,Array.isArray(a)?a:[a],Array.isArray(u)?u:[u])||i}else e.push(a),i=!0;else{const l=String(a);u&&u.nodeType===3&&u.data===l?e.push(u):e.push(document.createTextNode(l))}}return i}function Ir(e,t,n=null){for(let r=0,i=t.length;r<i;r++)e.insertBefore(t[r],n)}function Ye(e,t,n,r){if(n===void 0)return e.textContent="";const i=r||document.createTextNode("");if(t.length){let o=!1;for(let s=t.length-1;s>=0;s--){const a=t[s];if(i!==a){const u=a.parentNode===e;!o&&!s?u?e.replaceChild(i,a):e.insertBefore(i,n):u&&a.remove()}else o=!0}}else e.insertBefore(i,n);return[i]}const Io=!1;function Do(e,t,n){return e.addEventListener(t,n),()=>e.removeEventListener(t,n)}function Po([e,t],n,r){return[n?()=>n(e()):e,r?i=>t(r(i)):t]}function To(e){try{return document.querySelector(e)}catch{return null}}function Ro(e,t){const n=To(`#${e}`);n?n.scrollIntoView():t&&window.scrollTo(0,0)}function $o(e,t,n,r){let i=!1;const o=a=>typeof a=="string"?{value:a}:a,s=Po(G(o(e()),{equals:(a,u)=>a.value===u.value}),void 0,a=>(!i&&t(a),a));return n&&St(n((a=e())=>{i=!0,s[1](o(a)),i=!1})),{signal:s,utils:r}}function Ko(e){if(e){if(Array.isArray(e))return{signal:e}}else return{signal:G({value:""})};return e}function Oo(){return $o(()=>({value:window.location.pathname+window.location.search+window.location.hash,state:history.state}),({value:e,replace:t,scroll:n,state:r})=>{t?window.history.replaceState(r,"",e):window.history.pushState(r,"",e),Ro(window.location.hash.slice(1),n)},e=>Do(window,"popstate",()=>e()),{go:e=>window.history.go(e)})}const Bo=/^(?:[a-z0-9]+:)?\/\//i,Mo=/^\/+|\/+$/g;function ct(e,t=!1){const n=e.replace(Mo,"");return n?t||/^[?#]/.test(n)?n:"/"+n:""}function Nt(e,t,n){if(Bo.test(t))return;const r=ct(e),i=n&&ct(n);let o="";return!i||t.startsWith("/")?o=r:i.toLowerCase().indexOf(r.toLowerCase())!==0?o=r+i:o=i,(o||"/")+ct(t,!o)}function Lo(e,t){if(e==null)throw new Error(t);return e}function si(e,t){return ct(e).replace(/\/*(\*.*)?$/g,"")+ct(t)}function No(e){const t={};return e.searchParams.forEach((n,r)=>{t[r]=n}),t}function Je(e,t){return decodeURIComponent(t?e.replace(/\+/g," "):e)}function Fo(e,t){const[n,r]=e.split("/*",2),i=n.split("/").filter(Boolean),o=i.length;return s=>{const a=s.split("/").filter(Boolean),u=a.length-o;if(u<0||u>0&&r===void 0&&!t)return null;const l={path:o?"":"/",params:{}};for(let c=0;c<o;c++){const f=i[c],d=a[c];if(f[0]===":")l.params[f.slice(1)]=d;else if(f.localeCompare(d,void 0,{sensitivity:"base"})!==0)return null;l.path+=`/${d}`}return r&&(l.params[r]=u?a.slice(-u).join("/"):""),l}}function jo(e){const[t,n]=e.pattern.split("/*",2),r=t.split("/").filter(Boolean);return r.reduce((i,o)=>i+(o.startsWith(":")?2:3),r.length-(n===void 0?0:1))}function ai(e){const t=new Map,n=eo();return new Proxy({},{get(r,i){return t.has(i)||to(n,()=>t.set(i,F(()=>e()[i]))),t.get(i)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(e())}})}function Wo(e,t){const n=new URLSearchParams(e);Object.entries(t).forEach(([i,o])=>{o==null||o===""?n.delete(i):n.set(i,String(o))});const r=n.toString();return r?`?${r}`:""}function ui(e){let t=/(\/?\:[^\/]+)\?/.exec(e);if(!t)return[e];let n=e.slice(0,t.index),r=e.slice(t.index+t[0].length);const i=[n,n+=t[1]];for(;t=/^(\/\:[^\/]+)\?/.exec(r);)i.push(n+=t[1]),r=r.slice(t[0].length);return ui(r).reduce((o,s)=>[...o,...i.map(a=>a+s)],[])}const Uo=100,li=Qr(),an=Qr(),Ct=()=>Lo(er(li),"Make sure your app is wrapped in a <Router />");let pt;const un=()=>pt||er(an)||Ct().base,Vo=e=>{const t=un();return F(()=>t.resolvePath(e()))},Ho=e=>{const t=Ct();return F(()=>{const n=e();return n!==void 0?t.renderPath(n):n})},or=()=>Ct().navigatorFactory(),ci=()=>Ct().location,ln=()=>un().params,fi=()=>{const e=ci(),t=or(),n=(r,i)=>{const o=fe(()=>Wo(e.search,r));t(e.pathname+o,{scroll:!1,...i})};return[e.query,n]};function zo(e,t="",n){const{component:r,data:i,children:o}=e,s=!o||Array.isArray(o)&&!o.length,a={key:e,element:r?()=>R(r,{}):()=>{const{element:u}=e;return u===void 0&&n?R(n,{}):u},preload:e.component?r.preload:e.preload,data:i};return di(e.path).reduce((u,l)=>{for(const c of ui(l)){const f=si(t,c),d=s?f:f.split("/*",1)[0];u.push({...a,originalPath:c,pattern:d,matcher:Fo(d,!s)})}return u},[])}function qo(e,t=0){return{routes:e,score:jo(e[e.length-1])*1e4-t,matcher(n){const r=[];for(let i=e.length-1;i>=0;i--){const o=e[i],s=o.matcher(n);if(!s)return null;r.unshift({...s,route:o})}return r}}}function di(e){return Array.isArray(e)?e:[e]}function hi(e,t="",n,r=[],i=[]){const o=di(e);for(let s=0,a=o.length;s<a;s++){const u=o[s];if(u&&typeof u=="object"&&u.hasOwnProperty("path")){const l=zo(u,t,n);for(const c of l){if(r.push(c),u.children)hi(u.children,c.pattern,n,r,i);else{const f=qo([...r],i.length);i.push(f)}r.pop()}}}return r.length?i:i.sort((s,a)=>a.score-s.score)}function Yo(e,t){for(let n=0,r=e.length;n<r;n++){const i=e[n].matcher(t);if(i)return i}return[]}function Xo(e,t){const n=new URL("http://sar"),r=F(u=>{const l=e();try{return new URL(l,n)}catch{return console.error(`Invalid path ${l}`),u}},n,{equals:(u,l)=>u.href===l.href}),i=F(()=>Je(r().pathname)),o=F(()=>Je(r().search,!0)),s=F(()=>Je(r().hash)),a=F(()=>"");return{get pathname(){return i()},get search(){return o()},get hash(){return s()},get state(){return t()},get key(){return a()},query:ai(Gr(o,()=>No(r())))}}function Go(e,t="",n,r){const{signal:[i,o],utils:s={}}=Ko(e),a=s.parsePath||(x=>x),u=s.renderPath||(x=>x),l=Nt("",t),c=void 0;if(l===void 0)throw new Error(`${l} is not a valid base path`);l&&!i().value&&o({value:l,replace:!0,scroll:!1});const[f,d]=G(!1),_=async x=>{d(!0);try{await no(x)}finally{d(!1)}},[p,y]=G(i().value),[S,v]=G(i().state),h=Xo(p,S),g=[],w={pattern:l,params:{},path:()=>l,outlet:()=>null,resolvePath(x){return Nt(l,x)}};if(n)try{pt=w,w.data=n({data:void 0,params:{},location:h,navigate:b(w)})}finally{pt=void 0}function m(x,E,I){fe(()=>{if(typeof E=="number"){E&&(s.go?s.go(E):console.warn("Router integration does not support relative routing"));return}const{replace:K,resolve:$,scroll:N,state:P}={replace:!1,resolve:!0,scroll:!0,...I},j=$?x.resolvePath(E):Nt("",E);if(j===void 0)throw new Error(`Path '${E}' is not a routable path`);if(g.length>=Uo)throw new Error("Too many redirects");const H=p();if((j!==H||P!==S())&&!Io){const Q=g.push({value:H,replace:K,scroll:N,state:S()});_(()=>{y(j),v(P)}).then(()=>{g.length===Q&&C({value:j,state:P})})}})}function b(x){return x=x||er(an)||w,(E,I)=>m(x,E,I)}function C(x){const E=g[0];E&&((x.value!==E.value||x.state!==E.state)&&o({...x,replace:E.replace,scroll:E.scroll}),g.length=0)}oe(()=>{const{value:x,state:E}=i();fe(()=>{x!==p()&&_(()=>{y(x),v(E)})})});{let x=function(E){if(E.defaultPrevented||E.button!==0||E.metaKey||E.altKey||E.ctrlKey||E.shiftKey)return;const I=E.composedPath().find(Q=>Q instanceof Node&&Q.nodeName.toUpperCase()==="A");if(!I||!I.hasAttribute("link"))return;const K=I.href;if(I.target||!K&&!I.hasAttribute("state"))return;const $=(I.getAttribute("rel")||"").split(/\s+/);if(I.hasAttribute("download")||$&&$.includes("external"))return;const N=new URL(K),P=Je(N.pathname);if(N.origin!==window.location.origin||l&&P&&!P.toLowerCase().startsWith(l.toLowerCase()))return;const j=a(P+Je(N.search,!0)+Je(N.hash)),H=I.getAttribute("state");E.preventDefault(),m(w,j,{resolve:!1,replace:I.hasAttribute("replace"),scroll:!I.hasAttribute("noscroll"),state:H&&JSON.parse(H)})};var A=x;ze(["click"]),document.addEventListener("click",x),St(()=>document.removeEventListener("click",x))}return{base:w,out:c,location:h,isRouting:f,renderPath:u,parsePath:a,navigatorFactory:b}}function Qo(e,t,n,r){const{base:i,location:o,navigatorFactory:s}=e,{pattern:a,element:u,preload:l,data:c}=r().route,f=F(()=>r().path),d=ai(()=>r().params);l&&l();const _={parent:t,pattern:a,get child(){return n()},path:f,params:d,data:t.data,outlet:u,resolvePath(p){return Nt(i.path(),p,f())}};if(c)try{pt=_,_.data=c({data:t.data,params:d,location:o,navigate:s(_)})}finally{pt=void 0}return _}const Jo=q("<a link></a>"),Zo=e=>{const{source:t,url:n,base:r,data:i,out:o}=e,s=t||Oo(),a=Go(s,r,i);return R(li.Provider,{value:a,get children(){return e.children}})},es=e=>{const t=Ct(),n=un(),r=tr(()=>e.children),i=F(()=>hi(r(),si(n.pattern,e.base||""),ts)),o=F(()=>Yo(i(),t.location.pathname));t.out&&t.out.matches.push(o().map(({route:l,path:c,params:f})=>({originalPath:l.originalPath,pattern:l.pattern,path:c,params:f})));const s=[];let a;const u=F(Gr(o,(l,c,f)=>{let d=c&&l.length===c.length;const _=[];for(let p=0,y=l.length;p<y;p++){const S=c&&c[p],v=l[p];f&&S&&v.route.key===S.route.key?_[p]=f[p]:(d=!1,s[p]&&s[p](),lt(h=>{s[p]=h,_[p]=Qo(t,_[p-1]||n,()=>u()[p+1],()=>o()[p])}))}return s.splice(l.length).forEach(p=>p()),f&&d?f:(a=_[0],_)}));return R(ue,{get when(){return u()&&a},children:l=>R(an.Provider,{value:l,get children(){return l.outlet()}})})},Be=e=>{const t=tr(()=>e.children);return En(e,{get children(){return t()}})},ts=()=>{const e=un();return R(ue,{get when(){return e.child},children:t=>R(an.Provider,{value:t,get children(){return t.outlet()}})})};function Se(e){e=En({inactiveClass:"inactive",activeClass:"active"},e);const[,t]=co(e,["href","state","activeClass","inactiveClass","end"]),n=Vo(()=>e.href),r=Ho(n),i=ci(),o=F(()=>{const s=n();if(s===void 0)return!1;const a=s.split(/[?#]/,1)[0].toLowerCase(),u=i.pathname.toLowerCase();return e.end?a===u:u.startsWith(a)});return(()=>{const s=Jo.cloneNode(!0);return Eo(s,En(t,{get href(){return r()||e.href},get state(){return JSON.stringify(e.state)},get classList(){return{[e.inactiveClass]:!o(),[e.activeClass]:o(),...t.classList}},get["aria-current"](){return o()?"page":void 0}}),!1,!1),s})()}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.
Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.
THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var O=function(){return O=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},O.apply(this,arguments)};function An(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,o;r<i;r++)(o||!(r in t))&&(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))}var U=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Y=Object.keys,Z=Array.isArray;typeof Promise<"u"&&!U.Promise&&(U.Promise=Promise);function ne(e,t){return typeof t!="object"||Y(t).forEach(function(n){e[n]=t[n]}),e}var vt=Object.getPrototypeOf,ns={}.hasOwnProperty;function se(e,t){return ns.call(e,t)}function tt(e,t){typeof t=="function"&&(t=t(vt(e))),(typeof Reflect>"u"?Y:Reflect.ownKeys)(t).forEach(function(n){Ee(e,n,t[n])})}var pi=Object.defineProperty;function Ee(e,t,n,r){pi(e,t,ne(n&&se(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function nt(e){return{from:function(t){return e.prototype=Object.create(t.prototype),Ee(e.prototype,"constructor",e),{extend:tt.bind(null,e.prototype)}}}}var rs=Object.getOwnPropertyDescriptor;function sr(e,t){var n=rs(e,t),r;return n||(r=vt(e))&&sr(r,t)}var is=[].slice;function cn(e,t,n){return is.call(e,t,n)}function vi(e,t){return t(e)}function at(e){if(!e)throw new Error("Assertion Failed")}function yi(e){U.setImmediate?setImmediate(e):setTimeout(e,0)}function mi(e,t){return e.reduce(function(n,r,i){var o=t(r,i);return o&&(n[o[0]]=o[1]),n},{})}function os(e,t,n){try{e.apply(null,n)}catch(r){t&&t(r)}}function xe(e,t){if(se(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var n=[],r=0,i=t.length;r<i;++r){var o=xe(e,t[r]);n.push(o)}return n}var s=t.indexOf(".");if(s!==-1){var a=e[t.substr(0,s)];return a===void 0?void 0:xe(a,t.substr(s+1))}}function ce(e,t,n){if(!(!e||t===void 0)&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){at(typeof n!="string"&&"length"in n);for(var r=0,i=t.length;r<i;++r)ce(e,t[r],n[r])}else{var o=t.indexOf(".");if(o!==-1){var s=t.substr(0,o),a=t.substr(o+1);if(a==="")n===void 0?Z(e)&&!isNaN(parseInt(s))?e.splice(s,1):delete e[s]:e[s]=n;else{var u=e[s];(!u||!se(e,s))&&(u=e[s]={}),ce(u,a,n)}}else n===void 0?Z(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function ss(e,t){typeof t=="string"?ce(e,t,void 0):"length"in t&&[].map.call(t,function(n){ce(e,n,void 0)})}function gi(e){var t={};for(var n in e)se(e,n)&&(t[n]=e[n]);return t}var as=[].concat;function wi(e){return as.apply([],e)}var bi="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(wi([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return U[e]}),us=bi.map(function(e){return U[e]});mi(bi,function(e){return[e,!0]});var De=null;function At(e){De=typeof WeakMap<"u"&&new WeakMap;var t=kn(e);return De=null,t}function kn(e){if(!e||typeof e!="object")return e;var t=De&&De.get(e);if(t)return t;if(Z(e)){t=[],De&&De.set(e,t);for(var n=0,r=e.length;n<r;++n)t.push(kn(e[n]))}else if(us.indexOf(e.constructor)>=0)t=e;else{var i=vt(e);t=i===Object.prototype?{}:Object.create(i),De&&De.set(e,t);for(var o in e)se(e,o)&&(t[o]=kn(e[o]))}return t}var ls={}.toString;function In(e){return ls.call(e).slice(8,-1)}var Dn=typeof Symbol<"u"?Symbol.iterator:"@@iterator",cs=typeof Dn=="symbol"?function(e){var t;return e!=null&&(t=e[Dn])&&t.apply(e)}:function(){return null},Qe={};function we(e){var t,n,r,i;if(arguments.length===1){if(Z(e))return e.slice();if(this===Qe&&typeof e=="string")return[e];if(i=cs(e)){for(n=[];r=i.next(),!r.done;)n.push(r.value);return n}if(e==null)return[e];if(t=e.length,typeof t=="number"){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var ar=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},ye=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function _i(e,t){ye=e,xi=t}var xi=function(){return!0},fs=!new Error("").stack;function qe(){if(fs)try{throw qe.arguments,new Error}catch(e){return e}return new Error}function Pn(e,t){var n=e.stack;return n?(t=t||0,n.indexOf(e.name)===0&&(t+=(e.name+e.message).split(`
`).length),n.split(`
`).slice(t).filter(xi).map(function(r){return`
`+r}).join("")):""}var ds=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],Si=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],ur=ds.concat(Si),hs={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function rt(e,t){this._e=qe(),this.name=e,this.message=t}nt(rt).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Pn(this._e,2))}},toString:function(){return this.name+": "+this.message}});function Ei(e,t){return e+". Errors: "+Object.keys(t).map(function(n){return t[n].toString()}).filter(function(n,r,i){return i.indexOf(n)===r}).join(`
`)}function Qt(e,t,n,r){this._e=qe(),this.failures=t,this.failedKeys=r,this.successCount=n,this.message=Ei(e,t)}nt(Qt).from(rt);function ft(e,t){this._e=qe(),this.name="BulkError",this.failures=Object.keys(t).map(function(n){return t[n]}),this.failuresByPos=t,this.message=Ei(e,t)}nt(ft).from(rt);var lr=ur.reduce(function(e,t){return e[t]=t+"Error",e},{}),ps=rt,T=ur.reduce(function(e,t){var n=t+"Error";function r(i,o){this._e=qe(),this.name=n,i?typeof i=="string"?(this.message=""+i+(o?`
 `+o:""),this.inner=o||null):typeof i=="object"&&(this.message=i.name+" "+i.message,this.inner=i):(this.message=hs[t]||n,this.inner=null)}return nt(r).from(ps),e[t]=r,e},{});T.Syntax=SyntaxError;T.Type=TypeError;T.Range=RangeError;var Dr=Si.reduce(function(e,t){return e[t+"Error"]=T[t],e},{});function vs(e,t){if(!e||e instanceof rt||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Dr[e.name])return e;var n=new Dr[e.name](t||e.message,e);return"stack"in e&&Ee(n,"stack",{get:function(){return this.inner.stack}}),n}var fn=ur.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=T[t]),e},{});fn.ModifyError=Qt;fn.DexieError=rt;fn.BulkError=ft;function L(){}function kt(e){return e}function ys(e,t){return e==null||e===kt?t:function(n){return t(e(n))}}function Ue(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function ms(e,t){return e===L?t:function(){var n=e.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?Ue(r,this.onsuccess):r),i&&(this.onerror=this.onerror?Ue(i,this.onerror):i),o!==void 0?o:n}}function gs(e,t){return e===L?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?Ue(n,this.onsuccess):n),r&&(this.onerror=this.onerror?Ue(r,this.onerror):r)}}function ws(e,t){return e===L?t:function(n){var r=e.apply(this,arguments);ne(n,r);var i=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var s=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?Ue(i,this.onsuccess):i),o&&(this.onerror=this.onerror?Ue(o,this.onerror):o),r===void 0?s===void 0?void 0:s:ne(r,s)}}function bs(e,t){return e===L?t:function(){return t.apply(this,arguments)===!1?!1:e.apply(this,arguments)}}function cr(e,t){return e===L?t:function(){var n=e.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return n.then(function(){return t.apply(r,o)})}return t.apply(this,arguments)}}var yt={},_s=100,xs=20,Ci=100,fr=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,vt(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,vt(t),e]}(),Tn=fr[0],Jt=fr[1],Rn=fr[2],Ai=Jt&&Jt.then,Ft=Tn&&Tn.constructor,dr=!!Rn,$n=!1,Ss=Rn?function(){Rn.then(Kt)}:U.setImmediate?setImmediate.bind(null,Kt):U.MutationObserver?function(){var e=document.createElement("div");new MutationObserver(function(){Kt(),e=null}).observe(e,{attributes:!0}),e.setAttribute("i","1")}:function(){setTimeout(Kt,0)},mt=function(e,t){ut.push([e,t]),Zt&&(Ss(),Zt=!1)},Kn=!0,Zt=!0,je=[],jt=[],On=null,Bn=kt,Ze={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Rr,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(function(e){try{Rr(e[0],e[1])}catch{}})}},D=Ze,ut=[],We=0,Wt=[];function k(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=L,this._lib=!1;var t=this._PSD=D;if(ye&&(this._stackHolder=qe(),this._prev=null,this._numPrev=0),typeof e!="function"){if(e!==yt)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Ln(this,this._value);return}this._state=null,this._value=null,++t.ref,Ii(this,e)}var Mn={get:function(){var e=D,t=en;function n(r,i){var o=this,s=!e.global&&(e!==D||t!==en),a=s&&!Ce(),u=new k(function(l,c){hr(o,new ki(nn(r,e,s,a),nn(i,e,s,a),l,c,e))});return ye&&Ti(u,this),u}return n.prototype=yt,n},set:function(e){Ee(this,"then",e&&e.prototype===yt?Mn:{get:function(){return e},set:Mn.set})}};tt(k.prototype,{then:Mn,_then:function(e,t){hr(this,new ki(null,null,e,t,D))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=arguments[0],n=arguments[1];return typeof t=="function"?this.then(null,function(r){return r instanceof t?n(r):Ut(r)}):this.then(null,function(r){return r&&r.name===t?n(r):Ut(r)})},finally:function(e){return this.then(function(t){return e(),t},function(t){return e(),Ut(t)})},stack:{get:function(){if(this._stack)return this._stack;try{$n=!0;var e=Pi(this,[],xs),t=e.join(`
From previous: `);return this._state!==null&&(this._stack=t),t}finally{$n=!1}}},timeout:function(e,t){var n=this;return e<1/0?new k(function(r,i){var o=setTimeout(function(){return i(new T.Timeout(t))},e);n.then(r,i).finally(clearTimeout.bind(null,o))}):this}});typeof Symbol<"u"&&Symbol.toStringTag&&Ee(k.prototype,Symbol.toStringTag,"Dexie.Promise");Ze.env=Ri();function ki(e,t,n,r,i){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=n,this.reject=r,this.psd=i}tt(k,{all:function(){var e=we.apply(null,arguments).map(tn);return new k(function(t,n){e.length===0&&t([]);var r=e.length;e.forEach(function(i,o){return k.resolve(i).then(function(s){e[o]=s,--r||t(e)},n)})})},resolve:function(e){if(e instanceof k)return e;if(e&&typeof e.then=="function")return new k(function(n,r){e.then(n,r)});var t=new k(yt,!0,e);return Ti(t,On),t},reject:Ut,race:function(){var e=we.apply(null,arguments).map(tn);return new k(function(t,n){e.map(function(r){return k.resolve(r).then(t,n)})})},PSD:{get:function(){return D},set:function(e){return D=e}},totalEchoes:{get:function(){return en}},newPSD:Re,usePSD:ot,scheduler:{get:function(){return mt},set:function(e){mt=e}},rejectionMapper:{get:function(){return Bn},set:function(e){Bn=e}},follow:function(e,t){return new k(function(n,r){return Re(function(i,o){var s=D;s.unhandleds=[],s.onunhandled=o,s.finalize=Ue(function(){var a=this;Cs(function(){a.unhandleds.length===0?i():o(a.unhandleds[0])})},s.finalize),e()},t,n,r)})}});Ft&&(Ft.allSettled&&Ee(k,"allSettled",function(){var e=we.apply(null,arguments).map(tn);return new k(function(t){e.length===0&&t([]);var n=e.length,r=new Array(n);e.forEach(function(i,o){return k.resolve(i).then(function(s){return r[o]={status:"fulfilled",value:s}},function(s){return r[o]={status:"rejected",reason:s}}).then(function(){return--n||t(r)})})})}),Ft.any&&typeof AggregateError<"u"&&Ee(k,"any",function(){var e=we.apply(null,arguments).map(tn);return new k(function(t,n){e.length===0&&n(new AggregateError([]));var r=e.length,i=new Array(r);e.forEach(function(o,s){return k.resolve(o).then(function(a){return t(a)},function(a){i[s]=a,--r||n(new AggregateError(i))})})})}));function Ii(e,t){try{t(function(n){if(e._state===null){if(n===e)throw new TypeError("A promise cannot be resolved with itself.");var r=e._lib&&It();n&&typeof n.then=="function"?Ii(e,function(i,o){n instanceof k?n._then(i,o):n.then(i,o)}):(e._state=!0,e._value=n,Di(e)),r&&Dt()}},Ln.bind(null,e))}catch(n){Ln(e,n)}}function Ln(e,t){if(jt.push(t),e._state===null){var n=e._lib&&It();t=Bn(t),e._state=!1,e._value=t,ye&&t!==null&&typeof t=="object"&&!t._promise&&os(function(){var r=sr(t,"stack");t._promise=e,Ee(t,"stack",{get:function(){return $n?r&&(r.get?r.get.apply(t):r.value):e.stack}})}),As(e),Di(e),n&&Dt()}}function Di(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)hr(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),We===0&&(++We,mt(function(){--We===0&&pr()},[]))}function hr(e,t){if(e._state===null){e._listeners.push(t);return}var n=e._state?t.onFulfilled:t.onRejected;if(n===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++We,mt(Es,[n,e,t])}function Es(e,t,n){try{On=t;var r,i=t._value;t._state?r=e(i):(jt.length&&(jt=[]),r=e(i),jt.indexOf(i)===-1&&ks(t)),n.resolve(r)}catch(o){n.reject(o)}finally{On=null,--We===0&&pr(),--n.psd.ref||n.psd.finalize()}}function Pi(e,t,n){if(t.length===n)return t;var r="";if(e._state===!1){var i=e._value,o,s;i!=null?(o=i.name||"Error",s=i.message||i,r=Pn(i,0)):(o=i,s=""),t.push(o+(s?": "+s:"")+r)}return ye&&(r=Pn(e._stackHolder,2),r&&t.indexOf(r)===-1&&t.push(r),e._prev&&Pi(e._prev,t,n)),t}function Ti(e,t){var n=t?t._numPrev+1:0;n<_s&&(e._prev=t,e._numPrev=n)}function Kt(){It()&&Dt()}function It(){var e=Kn;return Kn=!1,Zt=!1,e}function Dt(){var e,t,n;do for(;ut.length>0;)for(e=ut,ut=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}while(ut.length>0);Kn=!0,Zt=!0}function pr(){var e=je;je=[],e.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)});for(var t=Wt.slice(0),n=t.length;n;)t[--n]()}function Cs(e){function t(){e(),Wt.splice(Wt.indexOf(t),1)}Wt.push(t),++We,mt(function(){--We===0&&pr()},[])}function As(e){je.some(function(t){return t._value===e._value})||je.push(e)}function ks(e){for(var t=je.length;t;)if(je[--t]._value===e._value){je.splice(t,1);return}}function Ut(e){return new k(yt,!1,e)}function V(e,t){var n=D;return function(){var r=It(),i=D;try{return $e(n,!0),e.apply(this,arguments)}catch(o){t&&t(o)}finally{$e(i,!1),r&&Dt()}}}var J={awaits:0,echoes:0,id:0},Is=0,Vt=[],yn=0,en=0,Ds=0;function Re(e,t,n,r){var i=D,o=Object.create(i);o.parent=i,o.ref=0,o.global=!1,o.id=++Ds;var s=Ze.env;o.env=dr?{Promise:k,PromiseProp:{value:k,configurable:!0,writable:!0},all:k.all,race:k.race,allSettled:k.allSettled,any:k.any,resolve:k.resolve,reject:k.reject,nthen:Pr(s.nthen,o),gthen:Pr(s.gthen,o)}:{},t&&ne(o,t),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var a=ot(o,e,n,r);return o.ref===0&&o.finalize(),a}function it(){return J.id||(J.id=++Is),++J.awaits,J.echoes+=Ci,J.id}function Ce(){return J.awaits?(--J.awaits===0&&(J.id=0),J.echoes=J.awaits*Ci,!0):!1}(""+Ai).indexOf("[native code]")===-1&&(it=Ce=L);function tn(e){return J.echoes&&e&&e.constructor===Ft?(it(),e.then(function(t){return Ce(),t},function(t){return Ce(),X(t)})):e}function Ps(e){++en,(!J.echoes||--J.echoes===0)&&(J.echoes=J.id=0),Vt.push(D),$e(e,!0)}function Ts(){var e=Vt[Vt.length-1];Vt.pop(),$e(e,!1)}function $e(e,t){var n=D;if((t?J.echoes&&(!yn++||e!==D):yn&&(!--yn||e!==D))&&$i(t?Ps.bind(null,e):Ts),e!==D&&(D=e,n===Ze&&(Ze.env=Ri()),dr)){var r=Ze.env.Promise,i=e.env;Jt.then=i.nthen,r.prototype.then=i.gthen,(n.global||e.global)&&(Object.defineProperty(U,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function Ri(){var e=U.Promise;return dr?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(U,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:Jt.then,gthen:e.prototype.then}:{}}function ot(e,t,n,r,i){var o=D;try{return $e(e,!0),t(n,r,i)}finally{$e(o,!1)}}function $i(e){Ai.call(Tn,e)}function nn(e,t,n,r){return typeof e!="function"?e:function(){var i=D;n&&it(),$e(t,!0);try{return e.apply(this,arguments)}finally{$e(i,!1),r&&$i(Ce)}}}function Pr(e,t){return function(n,r){return e.call(this,nn(n,t),nn(r,t))}}var Tr="unhandledrejection";function Rr(e,t){var n;try{n=t.onuncatched(e)}catch{}if(n!==!1)try{var r,i={promise:t,reason:e};if(U.document&&document.createEvent?(r=document.createEvent("Event"),r.initEvent(Tr,!0,!0),ne(r,i)):U.CustomEvent&&(r=new CustomEvent(Tr,{detail:i}),ne(r,i)),r&&U.dispatchEvent&&(dispatchEvent(r),!U.PromiseRejectionEvent&&U.onunhandledrejection))try{U.onunhandledrejection(r)}catch{}ye&&r&&!r.defaultPrevented&&console.warn("Unhandled rejection: "+(e.stack||e))}catch{}}var X=k.reject;function Nn(e,t,n,r){if(!e.idbdb||!e._state.openComplete&&!D.letThrough&&!e._vip){if(e._state.openComplete)return X(new T.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._options.autoOpen)return X(new T.DatabaseClosed);e.open().catch(L)}return e._state.dbReadyPromise.then(function(){return Nn(e,t,n,r)})}else{var i=e._createTransaction(t,n,e._dbSchema);try{i.create(),e._state.PR1398_maxLoop=3}catch(o){return o.name===lr.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(function(){return Nn(e,t,n,r)})):X(o)}return i._promise(t,function(o,s){return Re(function(){return D.trans=i,r(o,s,i)})}).then(function(o){return i._completion.then(function(){return o})})}}var $r="3.2.2",Le=String.fromCharCode(65535),Fn=-1/0,me="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Ki="String expected.",dt=[],dn=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Rs=dn,$s=dn,Oi=function(e){return!/(dexie\.js|dexie\.min\.js)/.test(e)},hn="__dbnames",mn="readonly",gn="readwrite";function Ve(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var Bi={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Ot(e){return typeof e=="string"&&!/\./.test(e)?function(t){return t[e]===void 0&&e in t&&(t=At(t),delete t[e]),t}:function(t){return t}}var Ks=function(){function e(){}return e.prototype._trans=function(t,n,r){var i=this._tx||D.trans,o=this.name;function s(u,l,c){if(!c.schema[o])throw new T.NotFound("Table "+o+" not part of transaction");return n(c.idbtrans,c)}var a=It();try{return i&&i.db===this.db?i===D.trans?i._promise(t,s,r):Re(function(){return i._promise(t,s,r)},{trans:i,transless:D.transless||D}):Nn(this.db,t,[this.name],s)}finally{a&&Dt()}},e.prototype.get=function(t,n){var r=this;return t&&t.constructor===Object?this.where(t).first(n):this._trans("readonly",function(i){return r.core.get({trans:i,key:t}).then(function(o){return r.hook.reading.fire(o)})}).then(n)},e.prototype.where=function(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(Z(t))return new this.db.WhereClause(this,"["+t.join("+")+"]");var n=Y(t);if(n.length===1)return this.where(n[0]).equals(t[n[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(c){return c.compound&&n.every(function(f){return c.keyPath.indexOf(f)>=0})&&c.keyPath.every(function(f){return n.indexOf(f)>=0})})[0];if(r&&this.db._maxKey!==Le)return this.where(r.name).equals(r.keyPath.map(function(c){return t[c]}));!r&&ye&&console.warn("The query "+JSON.stringify(t)+" on "+this.name+" would benefit of a "+("compound index ["+n.join("+")+"]"));var i=this.schema.idxByName,o=this.db._deps.indexedDB;function s(c,f){try{return o.cmp(c,f)===0}catch{return!1}}var a=n.reduce(function(c,f){var d=c[0],_=c[1],p=i[f],y=t[f];return[d||p,d||!p?Ve(_,p&&p.multi?function(S){var v=xe(S,f);return Z(v)&&v.some(function(h){return s(y,h)})}:function(S){return s(y,xe(S,f))}):_]},[null,null]),u=a[0],l=a[1];return u?this.where(u.name).equals(t[u.keyPath]).filter(l):r?this.filter(l):this.where(n).equals("")},e.prototype.filter=function(t){return this.toCollection().and(t)},e.prototype.count=function(t){return this.toCollection().count(t)},e.prototype.offset=function(t){return this.toCollection().offset(t)},e.prototype.limit=function(t){return this.toCollection().limit(t)},e.prototype.each=function(t){return this.toCollection().each(t)},e.prototype.toArray=function(t){return this.toCollection().toArray(t)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(t){return new this.db.Collection(new this.db.WhereClause(this,Z(t)?"["+t.join("+")+"]":t))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(t){this.schema.mappedClass=t;var n=function(r){if(!r)return r;var i=Object.create(t.prototype);for(var o in r)if(se(r,o))try{i[o]=r[o]}catch{}return i};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),t},e.prototype.defineClass=function(){function t(n){ne(this,n)}return this.mapToClass(t)},e.prototype.add=function(t,n){var r=this,i=this.schema.primKey,o=i.auto,s=i.keyPath,a=t;return s&&o&&(a=Ot(s)(t)),this._trans("readwrite",function(u){return r.core.mutate({trans:u,type:"add",keys:n!=null?[n]:null,values:[a]})}).then(function(u){return u.numFailures?k.reject(u.failures[0]):u.lastResult}).then(function(u){if(s)try{ce(t,s,u)}catch{}return u})},e.prototype.update=function(t,n){if(typeof t=="object"&&!Z(t)){var r=xe(t,this.schema.primKey.keyPath);if(r===void 0)return X(new T.InvalidArgument("Given object does not contain its primary key"));try{typeof n!="function"?Y(n).forEach(function(i){ce(t,i,n[i])}):n(t,{value:t,primKey:r})}catch{}return this.where(":id").equals(r).modify(n)}else return this.where(":id").equals(t).modify(n)},e.prototype.put=function(t,n){var r=this,i=this.schema.primKey,o=i.auto,s=i.keyPath,a=t;return s&&o&&(a=Ot(s)(t)),this._trans("readwrite",function(u){return r.core.mutate({trans:u,type:"put",values:[a],keys:n!=null?[n]:null})}).then(function(u){return u.numFailures?k.reject(u.failures[0]):u.lastResult}).then(function(u){if(s)try{ce(t,s,u)}catch{}return u})},e.prototype.delete=function(t){var n=this;return this._trans("readwrite",function(r){return n.core.mutate({trans:r,type:"delete",keys:[t]})}).then(function(r){return r.numFailures?k.reject(r.failures[0]):void 0})},e.prototype.clear=function(){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"deleteRange",range:Bi})}).then(function(n){return n.numFailures?k.reject(n.failures[0]):void 0})},e.prototype.bulkGet=function(t){var n=this;return this._trans("readonly",function(r){return n.core.getMany({keys:t,trans:r}).then(function(i){return i.map(function(o){return n.hook.reading.fire(o)})})})},e.prototype.bulkAdd=function(t,n,r){var i=this,o=Array.isArray(n)?n:void 0;r=r||(o?void 0:n);var s=r?r.allKeys:void 0;return this._trans("readwrite",function(a){var u=i.schema.primKey,l=u.auto,c=u.keyPath;if(c&&o)throw new T.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(o&&o.length!==t.length)throw new T.InvalidArgument("Arguments objects and keys must have the same length");var f=t.length,d=c&&l?t.map(Ot(c)):t;return i.core.mutate({trans:a,type:"add",keys:o,values:d,wantResults:s}).then(function(_){var p=_.numFailures,y=_.results,S=_.lastResult,v=_.failures,h=s?y:S;if(p===0)return h;throw new ft(i.name+".bulkAdd(): "+p+" of "+f+" operations failed",v)})})},e.prototype.bulkPut=function(t,n,r){var i=this,o=Array.isArray(n)?n:void 0;r=r||(o?void 0:n);var s=r?r.allKeys:void 0;return this._trans("readwrite",function(a){var u=i.schema.primKey,l=u.auto,c=u.keyPath;if(c&&o)throw new T.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(o&&o.length!==t.length)throw new T.InvalidArgument("Arguments objects and keys must have the same length");var f=t.length,d=c&&l?t.map(Ot(c)):t;return i.core.mutate({trans:a,type:"put",keys:o,values:d,wantResults:s}).then(function(_){var p=_.numFailures,y=_.results,S=_.lastResult,v=_.failures,h=s?y:S;if(p===0)return h;throw new ft(i.name+".bulkPut(): "+p+" of "+f+" operations failed",v)})})},e.prototype.bulkDelete=function(t){var n=this,r=t.length;return this._trans("readwrite",function(i){return n.core.mutate({trans:i,type:"delete",keys:t})}).then(function(i){var o=i.numFailures,s=i.lastResult,a=i.failures;if(o===0)return s;throw new ft(n.name+".bulkDelete(): "+o+" of "+r+" operations failed",a)})},e}();function Pt(e){var t={},n=function(a,u){if(u){for(var l=arguments.length,c=new Array(l-1);--l;)c[l-1]=arguments[l];return t[a].subscribe.apply(null,c),e}else if(typeof a=="string")return t[a]};n.addEventType=o;for(var r=1,i=arguments.length;r<i;++r)o(arguments[r]);return n;function o(a,u,l){if(typeof a=="object")return s(a);u||(u=bs),l||(l=L);var c={subscribers:[],fire:l,subscribe:function(f){c.subscribers.indexOf(f)===-1&&(c.subscribers.push(f),c.fire=u(c.fire,f))},unsubscribe:function(f){c.subscribers=c.subscribers.filter(function(d){return d!==f}),c.fire=c.subscribers.reduce(u,l)}};return t[a]=n[a]=c,c}function s(a){Y(a).forEach(function(u){var l=a[u];if(Z(l))o(u,a[u][0],a[u][1]);else if(l==="asap")var c=o(u,kt,function(){for(var d=arguments.length,_=new Array(d);d--;)_[d]=arguments[d];c.subscribers.forEach(function(p){yi(function(){p.apply(null,_)})})});else throw new T.InvalidArgument("Invalid event config")})}}function Tt(e,t){return nt(t).from({prototype:e}),t}function Os(e){return Tt(Ks.prototype,function(n,r,i){this.db=e,this._tx=i,this.name=n,this.schema=r,this.hook=e._allTables[n]?e._allTables[n].hook:Pt(null,{creating:[ms,L],reading:[ys,kt],updating:[ws,L],deleting:[gs,L]})})}function Xe(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function wn(e,t){e.filter=Ve(e.filter,t)}function bn(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return Ve(r(),t())}:t,e.justLimit=n&&!r}function Bs(e,t){e.isMatch=Ve(e.isMatch,t)}function Ht(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new T.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function Kr(e,t,n){var r=Ht(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:r,range:e.range}})}function Bt(e,t,n,r){var i=e.replayFilter?Ve(e.filter,e.replayFilter()):e.filter;if(e.or){var o={},s=function(a,u,l){if(!i||i(u,l,function(d){return u.stop(d)},function(d){return u.fail(d)})){var c=u.primaryKey,f=""+c;f==="[object ArrayBuffer]"&&(f=""+new Uint8Array(c)),se(o,f)||(o[f]=!0,t(a,u,l))}};return Promise.all([e.or._iterate(s,n),Or(Kr(e,r,n),e.algorithm,s,!e.keysOnly&&e.valueMapper)])}else return Or(Kr(e,r,n),Ve(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function Or(e,t,n,r){var i=r?function(s,a,u){return n(r(s),a,u)}:n,o=V(i);return e.then(function(s){if(s)return s.start(function(){var a=function(){return s.continue()};(!t||t(s,function(u){return a=u},function(u){s.stop(u),a=L},function(u){s.fail(u),a=L}))&&o(s.value,s,function(u){return a=u}),a()})})}function te(e,t){try{var n=Br(e),r=Br(t);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return Ls(Mr(e),Mr(t));case"Array":return Ms(e,t)}}catch{}return NaN}function Ms(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,o=0;o<i;++o){var s=te(e[o],t[o]);if(s!==0)return s}return n===r?0:n<r?-1:1}function Ls(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,o=0;o<i;++o)if(e[o]!==t[o])return e[o]<t[o]?-1:1;return n===r?0:n<r?-1:1}function Br(e){var t=typeof e;if(t!=="object")return t;if(ArrayBuffer.isView(e))return"binary";var n=In(e);return n==="ArrayBuffer"?"binary":n}function Mr(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var Ns=function(){function e(){}return e.prototype._read=function(t,n){var r=this._ctx;return r.error?r.table._trans(null,X.bind(null,r.error)):r.table._trans("readonly",t).then(n)},e.prototype._write=function(t){var n=this._ctx;return n.error?n.table._trans(null,X.bind(null,n.error)):n.table._trans("readwrite",t,"locked")},e.prototype._addAlgorithm=function(t){var n=this._ctx;n.algorithm=Ve(n.algorithm,t)},e.prototype._iterate=function(t,n){return Bt(this._ctx,t,n,this._ctx.table.core)},e.prototype.clone=function(t){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return t&&ne(r,t),n._ctx=r,n},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(t){var n=this._ctx;return this._read(function(r){return Bt(n,t,r,n.table.core)})},e.prototype.count=function(t){var n=this;return this._read(function(r){var i=n._ctx,o=i.table.core;if(Xe(i,!0))return o.count({trans:r,query:{index:Ht(i,o.schema),range:i.range}}).then(function(a){return Math.min(a,i.limit)});var s=0;return Bt(i,function(){return++s,!1},r,o).then(function(){return s})}).then(t)},e.prototype.sortBy=function(t,n){var r=t.split(".").reverse(),i=r[0],o=r.length-1;function s(l,c){return c?s(l[r[c]],c-1):l[i]}var a=this._ctx.dir==="next"?1:-1;function u(l,c){var f=s(l,o),d=s(c,o);return f<d?-a:f>d?a:0}return this.toArray(function(l){return l.sort(u)}).then(n)},e.prototype.toArray=function(t){var n=this;return this._read(function(r){var i=n._ctx;if(i.dir==="next"&&Xe(i,!0)&&i.limit>0){var o=i.valueMapper,s=Ht(i,i.table.core.schema);return i.table.core.query({trans:r,limit:i.limit,values:!0,query:{index:s,range:i.range}}).then(function(u){var l=u.result;return o?l.map(o):l})}else{var a=[];return Bt(i,function(u){return a.push(u)},r,i.table.core).then(function(){return a})}},t)},e.prototype.offset=function(t){var n=this._ctx;return t<=0?this:(n.offset+=t,Xe(n)?bn(n,function(){var r=t;return function(i,o){return r===0?!0:r===1?(--r,!1):(o(function(){i.advance(r),r=0}),!1)}}):bn(n,function(){var r=t;return function(){return--r<0}}),this)},e.prototype.limit=function(t){return this._ctx.limit=Math.min(this._ctx.limit,t),bn(this._ctx,function(){var n=t;return function(r,i,o){return--n<=0&&i(o),n>=0}},!0),this},e.prototype.until=function(t,n){return wn(this._ctx,function(r,i,o){return t(r.value)?(i(o),n):!0}),this},e.prototype.first=function(t){return this.limit(1).toArray(function(n){return n[0]}).then(t)},e.prototype.last=function(t){return this.reverse().first(t)},e.prototype.filter=function(t){return wn(this._ctx,function(n){return t(n.value)}),Bs(this._ctx,t),this},e.prototype.and=function(t){return this.filter(t)},e.prototype.or=function(t){return new this.db.WhereClause(this._ctx.table,t,this)},e.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){t(i.key,i)})},e.prototype.eachUniqueKey=function(t){return this._ctx.unique="unique",this.eachKey(t)},e.prototype.eachPrimaryKey=function(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){t(i.primaryKey,i)})},e.prototype.keys=function(t){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,o){r.push(o.key)}).then(function(){return r}).then(t)},e.prototype.primaryKeys=function(t){var n=this._ctx;if(n.dir==="next"&&Xe(n,!0)&&n.limit>0)return this._read(function(i){var o=Ht(n,n.table.core.schema);return n.table.core.query({trans:i,values:!1,limit:n.limit,query:{index:o,range:n.range}})}).then(function(i){var o=i.result;return o}).then(t);n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,o){r.push(o.primaryKey)}).then(function(){return r}).then(t)},e.prototype.uniqueKeys=function(t){return this._ctx.unique="unique",this.keys(t)},e.prototype.firstKey=function(t){return this.limit(1).keys(function(n){return n[0]}).then(t)},e.prototype.lastKey=function(t){return this.reverse().firstKey(t)},e.prototype.distinct=function(){var t=this._ctx,n=t.index&&t.table.schema.idxByName[t.index];if(!n||!n.multi)return this;var r={};return wn(this._ctx,function(i){var o=i.primaryKey.toString(),s=se(r,o);return r[o]=!0,!s}),this},e.prototype.modify=function(t){var n=this,r=this._ctx;return this._write(function(i){var o;if(typeof t=="function")o=t;else{var s=Y(t),a=s.length;o=function(v){for(var h=!1,g=0;g<a;++g){var w=s[g],m=t[w];xe(v,w)!==m&&(ce(v,w,m),h=!0)}return h}}var u=r.table.core,l=u.schema.primaryKey,c=l.outbound,f=l.extractKey,d=n.db._options.modifyChunkSize||200,_=[],p=0,y=[],S=function(v,h){var g=h.failures,w=h.numFailures;p+=v-w;for(var m=0,b=Y(g);m<b.length;m++){var C=b[m];_.push(g[C])}};return n.clone().primaryKeys().then(function(v){var h=function(g){var w=Math.min(d,v.length-g);return u.getMany({trans:i,keys:v.slice(g,g+w),cache:"immutable"}).then(function(m){for(var b=[],C=[],A=c?[]:null,x=[],E=0;E<w;++E){var I=m[E],K={value:At(I),primKey:v[g+E]};o.call(K,K.value,K)!==!1&&(K.value==null?x.push(v[g+E]):!c&&te(f(I),f(K.value))!==0?(x.push(v[g+E]),b.push(K.value)):(C.push(K.value),c&&A.push(v[g+E])))}var $=Xe(r)&&r.limit===1/0&&(typeof t!="function"||t===_n)&&{index:r.index,range:r.range};return Promise.resolve(b.length>0&&u.mutate({trans:i,type:"add",values:b}).then(function(N){for(var P in N.failures)x.splice(parseInt(P),1);S(b.length,N)})).then(function(){return(C.length>0||$&&typeof t=="object")&&u.mutate({trans:i,type:"put",keys:A,values:C,criteria:$,changeSpec:typeof t!="function"&&t}).then(function(N){return S(C.length,N)})}).then(function(){return(x.length>0||$&&t===_n)&&u.mutate({trans:i,type:"delete",keys:x,criteria:$}).then(function(N){return S(x.length,N)})}).then(function(){return v.length>g+w&&h(g+d)})})};return h(0).then(function(){if(_.length>0)throw new Qt("Error modifying one or more objects",_,p,y);return v.length})})})},e.prototype.delete=function(){var t=this._ctx,n=t.range;return Xe(t)&&(t.isPrimKey&&!$s||n.type===3)?this._write(function(r){var i=t.table.core.schema.primaryKey,o=n;return t.table.core.count({trans:r,query:{index:i,range:o}}).then(function(s){return t.table.core.mutate({trans:r,type:"deleteRange",range:o}).then(function(a){var u=a.failures;a.lastResult,a.results;var l=a.numFailures;if(l)throw new Qt("Could not delete some values",Object.keys(u).map(function(c){return u[c]}),s-l);return s-l})})}):this.modify(_n)},e}(),_n=function(e,t){return t.value=null};function Fs(e){return Tt(Ns.prototype,function(n,r){this.db=e;var i=Bi,o=null;if(r)try{i=r()}catch(l){o=l}var s=n._ctx,a=s.table,u=a.hook.reading.fire;this._ctx={table:a,index:s.index,isPrimKey:!s.index||a.schema.primKey.keyPath&&s.index===a.schema.primKey.name,range:i,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:o,or:s.or,valueMapper:u!==kt?u:null}})}function js(e,t){return e<t?-1:e===t?0:1}function Ws(e,t){return e>t?-1:e===t?0:1}function ie(e,t,n){var r=e instanceof Li?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function Ge(e){return new e.Collection(e,function(){return Mi("")}).limit(0)}function Us(e){return e==="next"?function(t){return t.toUpperCase()}:function(t){return t.toLowerCase()}}function Vs(e){return e==="next"?function(t){return t.toLowerCase()}:function(t){return t.toUpperCase()}}function Hs(e,t,n,r,i,o){for(var s=Math.min(e.length,r.length),a=-1,u=0;u<s;++u){var l=t[u];if(l!==r[u])return i(e[u],n[u])<0?e.substr(0,u)+n[u]+n.substr(u+1):i(e[u],r[u])<0?e.substr(0,u)+r[u]+n.substr(u+1):a>=0?e.substr(0,a)+t[a]+n.substr(a+1):null;i(e[u],l)<0&&(a=u)}return s<r.length&&o==="next"?e+n.substr(e.length):s<e.length&&o==="prev"?e.substr(0,n.length):a<0?null:e.substr(0,a)+r[a]+n.substr(a+1)}function Mt(e,t,n,r){var i,o,s,a,u,l,c,f=n.length;if(!n.every(function(y){return typeof y=="string"}))return ie(e,Ki);function d(y){i=Us(y),o=Vs(y),s=y==="next"?js:Ws;var S=n.map(function(v){return{lower:o(v),upper:i(v)}}).sort(function(v,h){return s(v.lower,h.lower)});a=S.map(function(v){return v.upper}),u=S.map(function(v){return v.lower}),l=y,c=y==="next"?"":r}d("next");var _=new e.Collection(e,function(){return Ie(a[0],u[f-1]+r)});_._ondirectionchange=function(y){d(y)};var p=0;return _._addAlgorithm(function(y,S,v){var h=y.key;if(typeof h!="string")return!1;var g=o(h);if(t(g,u,p))return!0;for(var w=null,m=p;m<f;++m){var b=Hs(h,g,a[m],u[m],s,l);b===null&&w===null?p=m+1:(w===null||s(w,b)>0)&&(w=b)}return S(w!==null?function(){y.continue(w+c)}:v),!1}),_}function Ie(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function Mi(e){return{type:1,lower:e,upper:e}}var Li=function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),e.prototype.between=function(t,n,r,i){r=r!==!1,i=i===!0;try{return this._cmp(t,n)>0||this._cmp(t,n)===0&&(r||i)&&!(r&&i)?Ge(this):new this.Collection(this,function(){return Ie(t,n,!r,!i)})}catch{return ie(this,me)}},e.prototype.equals=function(t){return t==null?ie(this,me):new this.Collection(this,function(){return Mi(t)})},e.prototype.above=function(t){return t==null?ie(this,me):new this.Collection(this,function(){return Ie(t,void 0,!0)})},e.prototype.aboveOrEqual=function(t){return t==null?ie(this,me):new this.Collection(this,function(){return Ie(t,void 0,!1)})},e.prototype.below=function(t){return t==null?ie(this,me):new this.Collection(this,function(){return Ie(void 0,t,!1,!0)})},e.prototype.belowOrEqual=function(t){return t==null?ie(this,me):new this.Collection(this,function(){return Ie(void 0,t)})},e.prototype.startsWith=function(t){return typeof t!="string"?ie(this,Ki):this.between(t,t+Le,!0,!0)},e.prototype.startsWithIgnoreCase=function(t){return t===""?this.startsWith(t):Mt(this,function(n,r){return n.indexOf(r[0])===0},[t],Le)},e.prototype.equalsIgnoreCase=function(t){return Mt(this,function(n,r){return n===r[0]},[t],"")},e.prototype.anyOfIgnoreCase=function(){var t=we.apply(Qe,arguments);return t.length===0?Ge(this):Mt(this,function(n,r){return r.indexOf(n)!==-1},t,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var t=we.apply(Qe,arguments);return t.length===0?Ge(this):Mt(this,function(n,r){return r.some(function(i){return n.indexOf(i)===0})},t,Le)},e.prototype.anyOf=function(){var t=this,n=we.apply(Qe,arguments),r=this._cmp;try{n.sort(r)}catch{return ie(this,me)}if(n.length===0)return Ge(this);var i=new this.Collection(this,function(){return Ie(n[0],n[n.length-1])});i._ondirectionchange=function(s){r=s==="next"?t._ascending:t._descending,n.sort(r)};var o=0;return i._addAlgorithm(function(s,a,u){for(var l=s.key;r(l,n[o])>0;)if(++o,o===n.length)return a(u),!1;return r(l,n[o])===0?!0:(a(function(){s.continue(n[o])}),!1)}),i},e.prototype.notEqual=function(t){return this.inAnyRange([[Fn,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var t=we.apply(Qe,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return ie(this,me)}var n=t.reduce(function(r,i){return r?r.concat([[r[r.length-1][1],i]]):[[Fn,i]]},null);return n.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(t,n){var r=this,i=this._cmp,o=this._ascending,s=this._descending,a=this._min,u=this._max;if(t.length===0)return Ge(this);if(!t.every(function(m){return m[0]!==void 0&&m[1]!==void 0&&o(m[0],m[1])<=0}))return ie(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",T.InvalidArgument);var l=!n||n.includeLowers!==!1,c=n&&n.includeUppers===!0;function f(m,b){for(var C=0,A=m.length;C<A;++C){var x=m[C];if(i(b[0],x[1])<0&&i(b[1],x[0])>0){x[0]=a(x[0],b[0]),x[1]=u(x[1],b[1]);break}}return C===A&&m.push(b),m}var d=o;function _(m,b){return d(m[0],b[0])}var p;try{p=t.reduce(f,[]),p.sort(_)}catch{return ie(this,me)}var y=0,S=c?function(m){return o(m,p[y][1])>0}:function(m){return o(m,p[y][1])>=0},v=l?function(m){return s(m,p[y][0])>0}:function(m){return s(m,p[y][0])>=0};function h(m){return!S(m)&&!v(m)}var g=S,w=new this.Collection(this,function(){return Ie(p[0][0],p[p.length-1][1],!l,!c)});return w._ondirectionchange=function(m){m==="next"?(g=S,d=o):(g=v,d=s),p.sort(_)},w._addAlgorithm(function(m,b,C){for(var A=m.key;g(A);)if(++y,y===p.length)return b(C),!1;return h(A)?!0:(r._cmp(A,p[y][1])===0||r._cmp(A,p[y][0])===0||b(function(){d===o?m.continue(p[y][0]):m.continue(p[y][1])}),!1)}),w},e.prototype.startsWithAnyOf=function(){var t=we.apply(Qe,arguments);return t.every(function(n){return typeof n=="string"})?t.length===0?Ge(this):this.inAnyRange(t.map(function(n){return[n,n+Le]})):ie(this,"startsWithAnyOf() only works with strings")},e}();function zs(e){return Tt(Li.prototype,function(n,r,i){this.db=e,this._ctx={table:n,index:r===":id"?null:r,or:i};var o=e._deps.indexedDB;if(!o)throw new T.MissingAPI;this._cmp=this._ascending=o.cmp.bind(o),this._descending=function(s,a){return o.cmp(a,s)},this._max=function(s,a){return o.cmp(s,a)>0?s:a},this._min=function(s,a){return o.cmp(s,a)<0?s:a},this._IDBKeyRange=e._deps.IDBKeyRange})}function pe(e){return V(function(t){return gt(t),e(t.target.error),!1})}function gt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var wt="storagemutated",Pe="x-storagemutated-1",Ke=Pt(null,wt),qs=function(){function e(){}return e.prototype._lock=function(){return at(!D.global),++this._reculock,this._reculock===1&&!D.global&&(D.lockOwnerFor=this),this},e.prototype._unlock=function(){if(at(!D.global),--this._reculock===0)for(D.global||(D.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{ot(t[1],t[0])}catch{}}return this},e.prototype._locked=function(){return this._reculock&&D.lockOwnerFor!==this},e.prototype.create=function(t){var n=this;if(!this.mode)return this;var r=this.db.idbdb,i=this.db._state.dbOpenError;if(at(!this.idbtrans),!t&&!r)switch(i&&i.name){case"DatabaseClosedError":throw new T.DatabaseClosed(i);case"MissingAPIError":throw new T.MissingAPI(i.message,i);default:throw new T.OpenFailed(i)}if(!this.active)throw new T.TransactionInactive;return at(this._completion._state===null),t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),t.onerror=V(function(o){gt(o),n._reject(t.error)}),t.onabort=V(function(o){gt(o),n.active&&n._reject(new T.Abort(t.error)),n.active=!1,n.on("abort").fire(o)}),t.oncomplete=V(function(){n.active=!1,n._resolve(),"mutatedParts"in t&&Ke.storagemutated.fire(t.mutatedParts)}),this},e.prototype._promise=function(t,n,r){var i=this;if(t==="readwrite"&&this.mode!=="readwrite")return X(new T.ReadOnly("Transaction is readonly"));if(!this.active)return X(new T.TransactionInactive);if(this._locked())return new k(function(s,a){i._blockedFuncs.push([function(){i._promise(t,n,r).then(s,a)},D])});if(r)return Re(function(){var s=new k(function(a,u){i._lock();var l=n(a,u,i);l&&l.then&&l.then(a,u)});return s.finally(function(){return i._unlock()}),s._lib=!0,s});var o=new k(function(s,a){var u=n(s,a,i);u&&u.then&&u.then(s,a)});return o._lib=!0,o},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(t){var n=this._root(),r=k.resolve(t);if(n._waitingFor)n._waitingFor=n._waitingFor.then(function(){return r});else{n._waitingFor=r,n._waitingQueue=[];var i=n.idbtrans.objectStore(n.storeNames[0]);(function s(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(i.get(-1/0).onsuccess=s)})()}var o=n._waitingFor;return new k(function(s,a){r.then(function(u){return n._waitingQueue.push(V(s.bind(null,u)))},function(u){return n._waitingQueue.push(V(a.bind(null,u)))}).finally(function(){n._waitingFor===o&&(n._waitingFor=null)})})},e.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new T.Abort))},e.prototype.table=function(t){var n=this._memoizedTables||(this._memoizedTables={});if(se(n,t))return n[t];var r=this.schema[t];if(!r)throw new T.NotFound("Table "+t+" not part of transaction");var i=new this.db.Table(t,r,this);return i.core=this.db.core.table(t),n[t]=i,i},e}();function Ys(e){return Tt(qs.prototype,function(n,r,i,o,s){var a=this;this.db=e,this.mode=n,this.storeNames=r,this.schema=i,this.chromeTransactionDurability=o,this.idbtrans=null,this.on=Pt(this,"complete","error","abort"),this.parent=s||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new k(function(u,l){a._resolve=u,a._reject=l}),this._completion.then(function(){a.active=!1,a.on.complete.fire()},function(u){var l=a.active;return a.active=!1,a.on.error.fire(u),a.parent?a.parent._reject(u):l&&a.idbtrans&&a.idbtrans.abort(),X(u)})})}function jn(e,t,n,r,i,o,s){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:o,src:(n&&!s?"&":"")+(r?"*":"")+(i?"++":"")+Ni(t)}}function Ni(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function Fi(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:mi(n,function(r){return[r.name,r]})}}function Xs(e){return e.length===1?e[0]:e}var bt=function(e){try{return e.only([[]]),bt=function(){return[[]]},[[]]}catch{return bt=function(){return Le},Le}};function Wn(e){return e==null?function(){}:typeof e=="string"?Gs(e):function(t){return xe(t,e)}}function Gs(e){var t=e.split(".");return t.length===1?function(n){return n[e]}:function(n){return xe(n,e)}}function Lr(e){return[].slice.call(e)}var Qs=0;function ht(e){return e==null?":id":typeof e=="string"?e:"["+e.join("+")+"]"}function Js(e,t,n){function r(f,d){var _=Lr(f.objectStoreNames);return{schema:{name:f.name,tables:_.map(function(p){return d.objectStore(p)}).map(function(p){var y=p.keyPath,S=p.autoIncrement,v=Z(y),h=y==null,g={},w={name:p.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:h,compound:v,keyPath:y,autoIncrement:S,unique:!0,extractKey:Wn(y)},indexes:Lr(p.indexNames).map(function(m){return p.index(m)}).map(function(m){var b=m.name,C=m.unique,A=m.multiEntry,x=m.keyPath,E=Z(x),I={name:b,compound:E,keyPath:x,unique:C,multiEntry:A,extractKey:Wn(x)};return g[ht(x)]=I,I}),getIndexByKeyPath:function(m){return g[ht(m)]}};return g[":id"]=w.primaryKey,y!=null&&(g[ht(y)]=w.primaryKey),w})},hasGetAll:_.length>0&&"getAll"in d.objectStore(_[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function i(f){if(f.type===3)return null;if(f.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var d=f.lower,_=f.upper,p=f.lowerOpen,y=f.upperOpen,S=d===void 0?_===void 0?null:t.upperBound(_,!!y):_===void 0?t.lowerBound(d,!!p):t.bound(d,_,!!p,!!y);return S}function o(f){var d=f.name;function _(S){var v=S.trans,h=S.type,g=S.keys,w=S.values,m=S.range;return new Promise(function(b,C){b=V(b);var A=v.objectStore(d),x=A.keyPath==null,E=h==="put"||h==="add";if(!E&&h!=="delete"&&h!=="deleteRange")throw new Error("Invalid operation type: "+h);var I=(g||w||{length:1}).length;if(g&&w&&g.length!==w.length)throw new Error("Given keys array must have same length as given values array.");if(I===0)return b({numFailures:0,failures:{},results:[],lastResult:void 0});var K,$=[],N=[],P=0,j=function(de){++P,gt(de)};if(h==="deleteRange"){if(m.type===4)return b({numFailures:P,failures:N,results:[],lastResult:void 0});m.type===3?$.push(K=A.clear()):$.push(K=A.delete(i(m)))}else{var H=E?x?[w,g]:[w,null]:[g,null],Q=H[0],re=H[1];if(E)for(var ae=0;ae<I;++ae)$.push(K=re&&re[ae]!==void 0?A[h](Q[ae],re[ae]):A[h](Q[ae])),K.onerror=j;else for(var ae=0;ae<I;++ae)$.push(K=A[h](Q[ae])),K.onerror=j}var ke=function(de){var st=de.target.result;$.forEach(function(le,Rt){return le.error!=null&&(N[Rt]=le.error)}),b({numFailures:P,failures:N,results:h==="delete"?g:$.map(function(le){return le.result}),lastResult:st})};K.onerror=function(de){j(de),ke(de)},K.onsuccess=ke})}function p(S){var v=S.trans,h=S.values,g=S.query,w=S.reverse,m=S.unique;return new Promise(function(b,C){b=V(b);var A=g.index,x=g.range,E=v.objectStore(d),I=A.isPrimaryKey?E:E.index(A.name),K=w?m?"prevunique":"prev":m?"nextunique":"next",$=h||!("openKeyCursor"in I)?I.openCursor(i(x),K):I.openKeyCursor(i(x),K);$.onerror=pe(C),$.onsuccess=V(function(N){var P=$.result;if(!P){b(null);return}P.___id=++Qs,P.done=!1;var j=P.continue.bind(P),H=P.continuePrimaryKey;H&&(H=H.bind(P));var Q=P.advance.bind(P),re=function(){throw new Error("Cursor not started")},ae=function(){throw new Error("Cursor not stopped")};P.trans=v,P.stop=P.continue=P.continuePrimaryKey=P.advance=re,P.fail=V(C),P.next=function(){var ke=this,de=1;return this.start(function(){return de--?ke.continue():ke.stop()}).then(function(){return ke})},P.start=function(ke){var de=new Promise(function(le,Rt){le=V(le),$.onerror=pe(Rt),P.fail=Rt,P.stop=function(Xi){P.stop=P.continue=P.continuePrimaryKey=P.advance=ae,le(Xi)}}),st=function(){if($.result)try{ke()}catch(le){P.fail(le)}else P.done=!0,P.start=function(){throw new Error("Cursor behind last entry")},P.stop()};return $.onsuccess=V(function(le){$.onsuccess=st,st()}),P.continue=j,P.continuePrimaryKey=H,P.advance=Q,st(),de},b(P)},C)})}function y(S){return function(v){return new Promise(function(h,g){h=V(h);var w=v.trans,m=v.values,b=v.limit,C=v.query,A=b===1/0?void 0:b,x=C.index,E=C.range,I=w.objectStore(d),K=x.isPrimaryKey?I:I.index(x.name),$=i(E);if(b===0)return h({result:[]});if(S){var N=m?K.getAll($,A):K.getAllKeys($,A);N.onsuccess=function(Q){return h({result:Q.target.result})},N.onerror=pe(g)}else{var P=0,j=m||!("openKeyCursor"in K)?K.openCursor($):K.openKeyCursor($),H=[];j.onsuccess=function(Q){var re=j.result;if(!re)return h({result:H});if(H.push(m?re.value:re.primaryKey),++P===b)return h({result:H});re.continue()},j.onerror=pe(g)}})}}return{name:d,schema:f,mutate:_,getMany:function(S){var v=S.trans,h=S.keys;return new Promise(function(g,w){g=V(g);for(var m=v.objectStore(d),b=h.length,C=new Array(b),A=0,x=0,E,I=function(P){var j=P.target;(C[j._pos]=j.result)!=null,++x===A&&g(C)},K=pe(w),$=0;$<b;++$){var N=h[$];N!=null&&(E=m.get(h[$]),E._pos=$,E.onsuccess=I,E.onerror=K,++A)}A===0&&g(C)})},get:function(S){var v=S.trans,h=S.key;return new Promise(function(g,w){g=V(g);var m=v.objectStore(d),b=m.get(h);b.onsuccess=function(C){return g(C.target.result)},b.onerror=pe(w)})},query:y(u),openCursor:p,count:function(S){var v=S.query,h=S.trans,g=v.index,w=v.range;return new Promise(function(m,b){var C=h.objectStore(d),A=g.isPrimaryKey?C:C.index(g.name),x=i(w),E=x?A.count(x):A.count();E.onsuccess=V(function(I){return m(I.target.result)}),E.onerror=pe(b)})}}}var s=r(e,n),a=s.schema,u=s.hasGetAll,l=a.tables.map(function(f){return o(f)}),c={};return l.forEach(function(f){return c[f.name]=f}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(f){var d=c[f];if(!d)throw new Error("Table '"+f+"' not found");return c[f]},MIN_KEY:-1/0,MAX_KEY:bt(t),schema:a}}function Zs(e,t){return t.reduce(function(n,r){var i=r.create;return O(O({},n),i(n))},e)}function ea(e,t,n,r){var i=n.IDBKeyRange;n.indexedDB;var o=Zs(Js(t,i,r),e.dbcore);return{dbcore:o}}function vr(e,t){var n=e._novip,r=t.db,i=ea(n._middlewares,r,n._deps,t);n.core=i.dbcore,n.tables.forEach(function(o){var s=o.name;n.core.schema.tables.some(function(a){return a.name===s})&&(o.core=n.core.table(s),n[s]instanceof n.Table&&(n[s].core=o.core))})}function rn(e,t,n,r){var i=e._novip;n.forEach(function(o){var s=r[o];t.forEach(function(a){var u=sr(a,o);(!u||"value"in u&&u.value===void 0)&&(a===i.Transaction.prototype||a instanceof i.Transaction?Ee(a,o,{get:function(){return this.table(o)},set:function(l){pi(this,o,{value:l,writable:!0,configurable:!0,enumerable:!0})}}):a[o]=new i.Table(o,s))})})}function Un(e,t){var n=e._novip;t.forEach(function(r){for(var i in r)r[i]instanceof n.Table&&delete r[i]})}function ta(e,t){return e._cfg.version-t._cfg.version}function na(e,t,n,r){var i=e._dbSchema,o=e._createTransaction("readwrite",e._storeNames,i);o.create(n),o._completion.catch(r);var s=o._reject.bind(o),a=D.transless||D;Re(function(){D.trans=o,D.transless=a,t===0?(Y(i).forEach(function(u){yr(n,u,i[u].primKey,i[u].indexes)}),vr(e,n),k.follow(function(){return e.on.populate.fire(o)}).catch(s)):ra(e,t,o,n).catch(s)})}function ra(e,t,n,r){var i=e._novip,o=[],s=i._versions,a=i._dbSchema=mr(i,i.idbdb,r),u=!1,l=s.filter(function(f){return f._cfg.version>=t});l.forEach(function(f){o.push(function(){var d=a,_=f._cfg.dbschema;Hn(i,d,r),Hn(i,_,r),a=i._dbSchema=_;var p=ji(d,_);p.add.forEach(function(w){yr(r,w[0],w[1].primKey,w[1].indexes)}),p.change.forEach(function(w){if(w.recreate)throw new T.Upgrade("Not yet support for changing primary key");var m=r.objectStore(w.name);w.add.forEach(function(b){return Vn(m,b)}),w.change.forEach(function(b){m.deleteIndex(b.name),Vn(m,b)}),w.del.forEach(function(b){return m.deleteIndex(b)})});var y=f._cfg.contentUpgrade;if(y&&f._cfg.version>t){vr(i,r),n._memoizedTables={},u=!0;var S=gi(_);p.del.forEach(function(w){S[w]=d[w]}),Un(i,[i.Transaction.prototype]),rn(i,[i.Transaction.prototype],Y(S),S),n.schema=S;var v=ar(y);v&&it();var h,g=k.follow(function(){if(h=y(n),h&&v){var w=Ce.bind(null,null);h.then(w,w)}});return h&&typeof h.then=="function"?k.resolve(h):g.then(function(){return h})}}),o.push(function(d){if(!u||!Rs){var _=f._cfg.dbschema;oa(_,d)}Un(i,[i.Transaction.prototype]),rn(i,[i.Transaction.prototype],i._storeNames,i._dbSchema),n.schema=i._dbSchema})});function c(){return o.length?k.resolve(o.shift()(n.idbtrans)).then(c):k.resolve()}return c().then(function(){ia(a,r)})}function ji(e,t){var n={del:[],add:[],change:[]},r;for(r in e)t[r]||n.del.push(r);for(r in t){var i=e[r],o=t[r];if(!i)n.add.push([r,o]);else{var s={name:r,def:o,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(o.primKey.keyPath||"")||i.primKey.auto!==o.primKey.auto&&!dn)s.recreate=!0,n.change.push(s);else{var a=i.idxByName,u=o.idxByName,l=void 0;for(l in a)u[l]||s.del.push(l);for(l in u){var c=a[l],f=u[l];c?c.src!==f.src&&s.change.push(f):s.add.push(f)}(s.del.length>0||s.add.length>0||s.change.length>0)&&n.change.push(s)}}}return n}function yr(e,t,n,r){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(o){return Vn(i,o)}),i}function ia(e,t){Y(e).forEach(function(n){t.db.objectStoreNames.contains(n)||yr(t,n,e[n].primKey,e[n].indexes)})}function oa(e,t){[].slice.call(t.db.objectStoreNames).forEach(function(n){return e[n]==null&&t.db.deleteObjectStore(n)})}function Vn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function mr(e,t,n){var r={},i=cn(t.objectStoreNames,0);return i.forEach(function(o){for(var s=n.objectStore(o),a=s.keyPath,u=jn(Ni(a),a||"",!1,!1,!!s.autoIncrement,a&&typeof a!="string",!0),l=[],c=0;c<s.indexNames.length;++c){var f=s.index(s.indexNames[c]);a=f.keyPath;var d=jn(f.name,a,!!f.unique,!!f.multiEntry,!1,a&&typeof a!="string",!1);l.push(d)}r[o]=Fi(o,u,l)}),r}function sa(e,t,n){var r=e._novip;r.verno=t.version/10;var i=r._dbSchema=mr(r,t,n);r._storeNames=cn(t.objectStoreNames,0),rn(r,[r._allTables],Y(i),i)}function aa(e,t){var n=mr(e,e.idbdb,t),r=ji(n,e._dbSchema);return!(r.add.length||r.change.some(function(i){return i.add.length||i.change.length}))}function Hn(e,t,n){for(var r=e._novip,i=n.db.objectStoreNames,o=0;o<i.length;++o){var s=i[o],a=n.objectStore(s);r._hasGetAll="getAll"in a;for(var u=0;u<a.indexNames.length;++u){var l=a.indexNames[u],c=a.index(l).keyPath,f=typeof c=="string"?c:"["+cn(c).join("+")+"]";if(t[s]){var d=t[s].idxByName[f];d&&(d.name=l,delete t[s].idxByName[f],t[s].idxByName[l]=d)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&U.WorkerGlobalScope&&U instanceof U.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(r._hasGetAll=!1)}function ua(e){return e.split(",").map(function(t,n){t=t.trim();var r=t.replace(/([&*]|\+\+)/g,""),i=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return jn(r,i||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),Z(i),n===0)})}var la=function(){function e(){}return e.prototype._parseStoresSpec=function(t,n){Y(t).forEach(function(r){if(t[r]!==null){var i=ua(t[r]),o=i.shift();if(o.multi)throw new T.Schema("Primary key cannot be multi-valued");i.forEach(function(s){if(s.auto)throw new T.Schema("Only primary key can be marked as autoIncrement (++)");if(!s.keyPath)throw new T.Schema("Index must have a name and cannot be an empty string")}),n[r]=Fi(r,o,i)}})},e.prototype.stores=function(t){var n=this.db;this._cfg.storesSource=this._cfg.storesSource?ne(this._cfg.storesSource,t):t;var r=n._versions,i={},o={};return r.forEach(function(s){ne(i,s._cfg.storesSource),o=s._cfg.dbschema={},s._parseStoresSpec(i,o)}),n._dbSchema=o,Un(n,[n._allTables,n,n.Transaction.prototype]),rn(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],Y(o),o),n._storeNames=Y(o),this},e.prototype.upgrade=function(t){return this._cfg.contentUpgrade=cr(this._cfg.contentUpgrade||L,t),this},e}();function ca(e){return Tt(la.prototype,function(n){this.db=e,this._cfg={version:n,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function gr(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new xr(hn,{addons:[],indexedDB:e,IDBKeyRange:t}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function wr(e){return e&&typeof e.databases=="function"}function fa(e){var t=e.indexedDB,n=e.IDBKeyRange;return wr(t)?Promise.resolve(t.databases()).then(function(r){return r.map(function(i){return i.name}).filter(function(i){return i!==hn})}):gr(t,n).toCollection().primaryKeys()}function da(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!wr(n)&&t!==hn&&gr(n,r).put({name:t}).catch(L)}function ha(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!wr(n)&&t!==hn&&gr(n,r).delete(t).catch(L)}function zn(e){return Re(function(){return D.letThrough=!0,e()})}function pa(){var e=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!e||!indexedDB.databases)return Promise.resolve();var t;return new Promise(function(n){var r=function(){return indexedDB.databases().finally(n)};t=setInterval(r,100),r()}).finally(function(){return clearInterval(t)})}function va(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?X(t.dbOpenError):e});ye&&(t.openCanceller._stackHolder=qe()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.openCanceller;function i(){if(t.openCanceller!==r)throw new T.DatabaseClosed("db.open() was cancelled")}var o=t.dbReadyResolve,s=null,a=!1;return k.race([r,(typeof navigator>"u"?k.resolve():pa()).then(function(){return new k(function(u,l){if(i(),!n)throw new T.MissingAPI;var c=e.name,f=t.autoSchema?n.open(c):n.open(c,Math.round(e.verno*10));if(!f)throw new T.MissingAPI;f.onerror=pe(l),f.onblocked=V(e._fireOnBlocked),f.onupgradeneeded=V(function(d){if(s=f.transaction,t.autoSchema&&!e._options.allowEmptyDB){f.onerror=gt,s.abort(),f.result.close();var _=n.deleteDatabase(c);_.onsuccess=_.onerror=V(function(){l(new T.NoSuchDatabase("Database "+c+" doesnt exist"))})}else{s.onerror=pe(l);var p=d.oldVersion>Math.pow(2,62)?0:d.oldVersion;a=p<1,e._novip.idbdb=f.result,na(e,p/10,s,l)}},l),f.onsuccess=V(function(){s=null;var d=e._novip.idbdb=f.result,_=cn(d.objectStoreNames);if(_.length>0)try{var p=d.transaction(Xs(_),"readonly");t.autoSchema?sa(e,d,p):(Hn(e,e._dbSchema,p),aa(e,p)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),vr(e,p)}catch{}dt.push(e),d.onversionchange=V(function(y){t.vcFired=!0,e.on("versionchange").fire(y)}),d.onclose=V(function(y){e.on("close").fire(y)}),a&&da(e._deps,c),u()},l)})})]).then(function(){return i(),t.onReadyBeingFired=[],k.resolve(zn(function(){return e.on.ready.fire(e.vip)})).then(function u(){if(t.onReadyBeingFired.length>0){var l=t.onReadyBeingFired.reduce(cr,L);return t.onReadyBeingFired=[],k.resolve(zn(function(){return l(e.vip)})).then(u)}})}).finally(function(){t.onReadyBeingFired=null,t.isBeingOpened=!1}).then(function(){return e}).catch(function(u){t.dbOpenError=u;try{s&&s.abort()}catch{}return r===t.openCanceller&&e._close(),X(u)}).finally(function(){t.openComplete=!0,o()})}function qn(e){var t=function(s){return e.next(s)},n=function(s){return e.throw(s)},r=o(t),i=o(n);function o(s){return function(a){var u=s(a),l=u.value;return u.done?l:!l||typeof l.then!="function"?Z(l)?Promise.all(l).then(r,i):r(l):l.then(r,i)}}return o(t)()}function ya(e,t,n){var r=arguments.length;if(r<2)throw new T.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];n=i.pop();var o=wi(i);return[e,o,n]}function Wi(e,t,n,r,i){return k.resolve().then(function(){var o=D.transless||D,s=e._createTransaction(t,n,e._dbSchema,r),a={trans:s,transless:o};if(r)s.idbtrans=r.idbtrans;else try{s.create(),e._state.PR1398_maxLoop=3}catch(f){return f.name===lr.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(function(){return Wi(e,t,n,null,i)})):X(f)}var u=ar(i);u&&it();var l,c=k.follow(function(){if(l=i.call(s,s),l)if(u){var f=Ce.bind(null,null);l.then(f,f)}else typeof l.next=="function"&&typeof l.throw=="function"&&(l=qn(l))},a);return(l&&typeof l.then=="function"?k.resolve(l).then(function(f){return s.active?f:X(new T.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):c.then(function(){return l})).then(function(f){return r&&s._resolve(),s._completion.then(function(){return f})}).catch(function(f){return s._reject(f),X(f)})})}function Lt(e,t,n){for(var r=Z(e)?e.slice():[e],i=0;i<n;++i)r.push(t);return r}function ma(e){return O(O({},e),{table:function(t){var n=e.table(t),r=n.schema,i={},o=[];function s(y,S,v){var h=ht(y),g=i[h]=i[h]||[],w=y==null?0:typeof y=="string"?1:y.length,m=S>0,b=O(O({},v),{isVirtual:m,keyTail:S,keyLength:w,extractKey:Wn(y),unique:!m&&v.unique});if(g.push(b),b.isPrimaryKey||o.push(b),w>1){var C=w===2?y[0]:y.slice(0,w-1);s(C,S+1,v)}return g.sort(function(A,x){return A.keyTail-x.keyTail}),b}var a=s(r.primaryKey.keyPath,0,r.primaryKey);i[":id"]=[a];for(var u=0,l=r.indexes;u<l.length;u++){var c=l[u];s(c.keyPath,0,c)}function f(y){var S=i[ht(y)];return S&&S[0]}function d(y,S){return{type:y.type===1?2:y.type,lower:Lt(y.lower,y.lowerOpen?e.MAX_KEY:e.MIN_KEY,S),lowerOpen:!0,upper:Lt(y.upper,y.upperOpen?e.MIN_KEY:e.MAX_KEY,S),upperOpen:!0}}function _(y){var S=y.query.index;return S.isVirtual?O(O({},y),{query:{index:S,range:d(y.query.range,S.keyTail)}}):y}var p=O(O({},n),{schema:O(O({},r),{primaryKey:a,indexes:o,getIndexByKeyPath:f}),count:function(y){return n.count(_(y))},query:function(y){return n.query(_(y))},openCursor:function(y){var S=y.query.index,v=S.keyTail,h=S.isVirtual,g=S.keyLength;if(!h)return n.openCursor(y);function w(m){function b(A){A!=null?m.continue(Lt(A,y.reverse?e.MAX_KEY:e.MIN_KEY,v)):y.unique?m.continue(m.key.slice(0,g).concat(y.reverse?e.MIN_KEY:e.MAX_KEY,v)):m.continue()}var C=Object.create(m,{continue:{value:b},continuePrimaryKey:{value:function(A,x){m.continuePrimaryKey(Lt(A,e.MAX_KEY,v),x)}},primaryKey:{get:function(){return m.primaryKey}},key:{get:function(){var A=m.key;return g===1?A[0]:A.slice(0,g)}},value:{get:function(){return m.value}}});return C}return n.openCursor(_(y)).then(function(m){return m&&w(m)})}});return p}})}var ga={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:ma};function br(e,t,n,r){return n=n||{},r=r||"",Y(e).forEach(function(i){if(!se(t,i))n[r+i]=void 0;else{var o=e[i],s=t[i];if(typeof o=="object"&&typeof s=="object"&&o&&s){var a=In(o),u=In(s);a!==u?n[r+i]=t[i]:a==="Object"?br(o,s,n,r+i+"."):o!==s&&(n[r+i]=t[i])}else o!==s&&(n[r+i]=t[i])}}),Y(t).forEach(function(i){se(e,i)||(n[r+i]=t[i])}),n}function wa(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var ba={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return O(O({},e),{table:function(t){var n=e.table(t),r=n.schema.primaryKey,i=O(O({},n),{mutate:function(o){var s=D.trans,a=s.table(t).hook,u=a.deleting,l=a.creating,c=a.updating;switch(o.type){case"add":if(l.fire===L)break;return s._promise("readwrite",function(){return f(o)},!0);case"put":if(l.fire===L&&c.fire===L)break;return s._promise("readwrite",function(){return f(o)},!0);case"delete":if(u.fire===L)break;return s._promise("readwrite",function(){return f(o)},!0);case"deleteRange":if(u.fire===L)break;return s._promise("readwrite",function(){return d(o)},!0)}return n.mutate(o);function f(p){var y=D.trans,S=p.keys||wa(r,p);if(!S)throw new Error("Keys missing");return p=p.type==="add"||p.type==="put"?O(O({},p),{keys:S}):O({},p),p.type!=="delete"&&(p.values=An([],p.values,!0)),p.keys&&(p.keys=An([],p.keys,!0)),_a(n,p,S).then(function(v){var h=S.map(function(g,w){var m=v[w],b={onerror:null,onsuccess:null};if(p.type==="delete")u.fire.call(b,g,m,y);else if(p.type==="add"||m===void 0){var C=l.fire.call(b,g,p.values[w],y);g==null&&C!=null&&(g=C,p.keys[w]=g,r.outbound||ce(p.values[w],r.keyPath,g))}else{var A=br(m,p.values[w]),x=c.fire.call(b,A,g,m,y);if(x){var E=p.values[w];Object.keys(x).forEach(function(I){se(E,I)?E[I]=x[I]:ce(E,I,x[I])})}}return b});return n.mutate(p).then(function(g){for(var w=g.failures,m=g.results,b=g.numFailures,C=g.lastResult,A=0;A<S.length;++A){var x=m?m[A]:S[A],E=h[A];x==null?E.onerror&&E.onerror(w[A]):E.onsuccess&&E.onsuccess(p.type==="put"&&v[A]?p.values[A]:x)}return{failures:w,results:m,numFailures:b,lastResult:C}}).catch(function(g){return h.forEach(function(w){return w.onerror&&w.onerror(g)}),Promise.reject(g)})})}function d(p){return _(p.trans,p.range,1e4)}function _(p,y,S){return n.query({trans:p,values:!1,query:{index:r,range:y},limit:S}).then(function(v){var h=v.result;return f({type:"delete",keys:h,trans:p}).then(function(g){return g.numFailures>0?Promise.reject(g.failures[0]):h.length<S?{failures:[],numFailures:0,lastResult:void 0}:_(p,O(O({},y),{lower:h[h.length-1],lowerOpen:!0}),S)})})}}});return i}})}};function _a(e,t,n){return t.type==="add"?Promise.resolve([]):e.getMany({trans:t.trans,keys:n,cache:"immutable"})}function Ui(e,t,n){try{if(!t||t.keys.length<e.length)return null;for(var r=[],i=0,o=0;i<t.keys.length&&o<e.length;++i)te(t.keys[i],e[o])===0&&(r.push(n?At(t.values[i]):t.values[i]),++o);return r.length===e.length?r:null}catch{return null}}var xa={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return O(O({},n),{getMany:function(r){if(!r.cache)return n.getMany(r);var i=Ui(r.keys,r.trans._cache,r.cache==="clone");return i?k.resolve(i):n.getMany(r).then(function(o){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?At(o):o},o})},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),n.mutate(r)}})}}}},xn;function _r(e){return!("from"in e)}var ge=function(e,t){if(this)ne(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0});else{var n=new ge;return e&&"d"in e&&ne(n,e),n}};tt(ge.prototype,(xn={add:function(e){return on(this,e),this},addKey:function(e){return _t(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(n){return _t(t,n,n)}),this}},xn[Dn]=function(){return Yn(this)},xn));function _t(e,t,n){var r=te(t,n);if(!isNaN(r)){if(r>0)throw RangeError();if(_r(e))return ne(e,{from:t,to:n,d:1});var i=e.l,o=e.r;if(te(n,e.from)<0)return i?_t(i,t,n):e.l={from:t,to:n,d:1,l:null,r:null},Nr(e);if(te(t,e.to)>0)return o?_t(o,t,n):e.r={from:t,to:n,d:1,l:null,r:null},Nr(e);te(t,e.from)<0&&(e.from=t,e.l=null,e.d=o?o.d+1:1),te(n,e.to)>0&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1);var s=!e.r;i&&!e.l&&on(e,i),o&&s&&on(e,o)}}function on(e,t){function n(r,i){var o=i.from,s=i.to,a=i.l,u=i.r;_t(r,o,s),a&&n(r,a),u&&n(r,u)}_r(t)||n(e,t)}function Sa(e,t){var n=Yn(t),r=n.next();if(r.done)return!1;for(var i=r.value,o=Yn(e),s=o.next(i.from),a=s.value;!r.done&&!s.done;){if(te(a.from,i.to)<=0&&te(a.to,i.from)>=0)return!0;te(i.from,a.from)<0?i=(r=n.next(a.from)).value:a=(s=o.next(i.from)).value}return!1}function Yn(e){var t=_r(e)?null:{s:0,n:e};return{next:function(n){for(var r=arguments.length>0;t;)switch(t.s){case 0:if(t.s=1,r)for(;t.n.l&&te(n,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!r||te(n,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function Nr(e){var t,n,r=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((n=e.l)===null||n===void 0?void 0:n.d)||0),i=r>1?"r":r<-1?"l":"";if(i){var o=i==="r"?"l":"r",s=O({},e),a=e[i];e.from=a.from,e.to=a.to,e[i]=a[i],s[i]=a[o],e[o]=s,s.d=Fr(s)}e.d=Fr(e)}function Fr(e){var t=e.r,n=e.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}var Ea={stack:"dbcore",level:0,create:function(e){var t=e.schema.name,n=new ge(e.MIN_KEY,e.MAX_KEY);return O(O({},e),{table:function(r){var i=e.table(r),o=i.schema,s=o.primaryKey,a=s.extractKey,u=s.outbound,l=O(O({},i),{mutate:function(d){var _=d.trans,p=_.mutatedParts||(_.mutatedParts={}),y=function(C){var A="idb://"+t+"/"+r+"/"+C;return p[A]||(p[A]=new ge)},S=y(""),v=y(":dels"),h=d.type,g=d.type==="deleteRange"?[d.range]:d.type==="delete"?[d.keys]:d.values.length<50?[[],d.values]:[],w=g[0],m=g[1],b=d.trans._cache;return i.mutate(d).then(function(C){if(Z(w)){h!=="delete"&&(w=C.results),S.addKeys(w);var A=Ui(w,b);!A&&h!=="add"&&v.addKeys(w),(A||m)&&Ca(y,o,A,m)}else if(w){var x={from:w.lower,to:w.upper};v.add(x),S.add(x)}else S.add(n),v.add(n),o.indexes.forEach(function(E){return y(E.name).add(n)});return C})}}),c=function(d){var _,p,y=d.query,S=y.index,v=y.range;return[S,new ge((_=v.lower)!==null&&_!==void 0?_:e.MIN_KEY,(p=v.upper)!==null&&p!==void 0?p:e.MAX_KEY)]},f={get:function(d){return[s,new ge(d.key)]},getMany:function(d){return[s,new ge().addKeys(d.keys)]},count:c,query:c,openCursor:c};return Y(f).forEach(function(d){l[d]=function(_){var p=D.subscr;if(p){var y=function(b){var C="idb://"+t+"/"+r+"/"+b;return p[C]||(p[C]=new ge)},S=y(""),v=y(":dels"),h=f[d](_),g=h[0],w=h[1];if(y(g.name||"").add(w),!g.isPrimaryKey)if(d==="count")v.add(n);else{var m=d==="query"&&u&&_.values&&i.query(O(O({},_),{values:!1}));return i[d].apply(this,arguments).then(function(b){if(d==="query"){if(u&&_.values)return m.then(function(E){var I=E.result;return S.addKeys(I),b});var C=_.values?b.result.map(a):b.result;_.values?S.addKeys(C):v.addKeys(C)}else if(d==="openCursor"){var A=b,x=_.values;return A&&Object.create(A,{key:{get:function(){return v.addKey(A.primaryKey),A.key}},primaryKey:{get:function(){var E=A.primaryKey;return v.addKey(E),E}},value:{get:function(){return x&&S.addKey(A.primaryKey),A.value}}})}return b})}}return i[d].apply(this,arguments)}}),l}})}};function Ca(e,t,n,r){function i(o){var s=e(o.name||"");function a(l){return l!=null?o.extractKey(l):null}var u=function(l){return o.multiEntry&&Z(l)?l.forEach(function(c){return s.addKey(c)}):s.addKey(l)};(n||r).forEach(function(l,c){var f=n&&a(n[c]),d=r&&a(r[c]);te(f,d)!==0&&(f!=null&&u(f),d!=null&&u(d))})}t.indexes.forEach(i)}var xr=function(){function e(t,n){var r=this;this._middlewares={},this.verno=0;var i=e.dependencies;this._options=n=O({addons:e.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};var o=n.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var s={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:L,dbReadyPromise:null,cancelOpen:L,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};s.dbReadyPromise=new k(function(a){s.dbReadyResolve=a}),s.openCanceller=new k(function(a,u){s.cancelOpen=u}),this._state=s,this.name=t,this.on=Pt(this,"populate","blocked","versionchange","close",{ready:[cr,L]}),this.on.ready.subscribe=vi(this.on.ready.subscribe,function(a){return function(u,l){e.vip(function(){var c=r._state;if(c.openComplete)c.dbOpenError||k.resolve().then(u),l&&a(u);else if(c.onReadyBeingFired)c.onReadyBeingFired.push(u),l&&a(u);else{a(u);var f=r;l||a(function d(){f.on.ready.unsubscribe(u),f.on.ready.unsubscribe(d)})}})}}),this.Collection=Fs(this),this.Table=Os(this),this.Transaction=Ys(this),this.Version=ca(this),this.WhereClause=zs(this),this.on("versionchange",function(a){a.newVersion>0?console.warn("Another connection wants to upgrade database '"+r.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+r.name+"'. Closing db now to resume the delete request."),r.close()}),this.on("blocked",function(a){!a.newVersion||a.newVersion<a.oldVersion?console.warn("Dexie.delete('"+r.name+"') was blocked"):console.warn("Upgrade '"+r.name+"' blocked by other connection holding version "+a.oldVersion/10)}),this._maxKey=bt(n.IDBKeyRange),this._createTransaction=function(a,u,l,c){return new r.Transaction(a,u,l,r._options.chromeTransactionDurability,c)},this._fireOnBlocked=function(a){r.on("blocked").fire(a),dt.filter(function(u){return u.name===r.name&&u!==r&&!u._state.vcFired}).map(function(u){return u.on("versionchange").fire(a)})},this.use(ga),this.use(ba),this.use(Ea),this.use(xa),this.vip=Object.create(this,{_vip:{value:!0}}),o.forEach(function(a){return a(r)})}return e.prototype.version=function(t){if(isNaN(t)||t<.1)throw new T.Type("Given version is not a positive number");if(t=Math.round(t*10)/10,this.idbdb||this._state.isBeingOpened)throw new T.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);var n=this._versions,r=n.filter(function(i){return i._cfg.version===t})[0];return r||(r=new this.Version(t),n.push(r),n.sort(ta),r.stores({}),this._state.autoSchema=!1,r)},e.prototype._whenReady=function(t){var n=this;return this.idbdb&&(this._state.openComplete||D.letThrough||this._vip)?t():new k(function(r,i){if(n._state.openComplete)return i(new T.DatabaseClosed(n._state.dbOpenError));if(!n._state.isBeingOpened){if(!n._options.autoOpen){i(new T.DatabaseClosed);return}n.open().catch(L)}n._state.dbReadyPromise.then(r,i)}).then(t)},e.prototype.use=function(t){var n=t.stack,r=t.create,i=t.level,o=t.name;o&&this.unuse({stack:n,name:o});var s=this._middlewares[n]||(this._middlewares[n]=[]);return s.push({stack:n,create:r,level:i??10,name:o}),s.sort(function(a,u){return a.level-u.level}),this},e.prototype.unuse=function(t){var n=t.stack,r=t.name,i=t.create;return n&&this._middlewares[n]&&(this._middlewares[n]=this._middlewares[n].filter(function(o){return i?o.create!==i:r?o.name!==r:!1})),this},e.prototype.open=function(){return va(this)},e.prototype._close=function(){var t=this._state,n=dt.indexOf(this);if(n>=0&&dt.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}t.dbReadyPromise=new k(function(r){t.dbReadyResolve=r}),t.openCanceller=new k(function(r,i){t.cancelOpen=i})},e.prototype.close=function(){this._close();var t=this._state;this._options.autoOpen=!1,t.dbOpenError=new T.DatabaseClosed,t.isBeingOpened&&t.cancelOpen(t.dbOpenError)},e.prototype.delete=function(){var t=this,n=arguments.length>0,r=this._state;return new k(function(i,o){var s=function(){t.close();var a=t._deps.indexedDB.deleteDatabase(t.name);a.onsuccess=V(function(){ha(t._deps,t.name),i()}),a.onerror=pe(o),a.onblocked=t._fireOnBlocked};if(n)throw new T.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(s):s()})},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return this.idbdb!==null},e.prototype.hasBeenClosed=function(){var t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"},e.prototype.hasFailed=function(){return this._state.dbOpenError!==null},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var t=this;return Y(this._allTables).map(function(n){return t._allTables[n]})},enumerable:!1,configurable:!0}),e.prototype.transaction=function(){var t=ya.apply(this,arguments);return this._transaction.apply(this,t)},e.prototype._transaction=function(t,n,r){var i=this,o=D.trans;(!o||o.db!==this||t.indexOf("!")!==-1)&&(o=null);var s=t.indexOf("?")!==-1;t=t.replace("!","").replace("?","");var a,u;try{if(u=n.map(function(c){var f=c instanceof i.Table?c.name:c;if(typeof f!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return f}),t=="r"||t===mn)a=mn;else if(t=="rw"||t==gn)a=gn;else throw new T.InvalidArgument("Invalid transaction mode: "+t);if(o){if(o.mode===mn&&a===gn)if(s)o=null;else throw new T.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");o&&u.forEach(function(c){if(o&&o.storeNames.indexOf(c)===-1)if(s)o=null;else throw new T.SubTransaction("Table "+c+" not included in parent transaction.")}),s&&o&&!o.active&&(o=null)}}catch(c){return o?o._promise(null,function(f,d){d(c)}):X(c)}var l=Wi.bind(null,this,a,u,o,r);return o?o._promise(a,l,"lock"):D.trans?ot(D.transless,function(){return i._whenReady(l)}):this._whenReady(l)},e.prototype.table=function(t){if(!se(this._allTables,t))throw new T.InvalidTable("Table "+t+" does not exist");return this._allTables[t]},e}(),Aa=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",ka=function(){function e(t){this._subscribe=t}return e.prototype.subscribe=function(t,n,r){return this._subscribe(!t||typeof t=="function"?{next:t,error:n,complete:r}:t)},e.prototype[Aa]=function(){return this},e}();function Vi(e,t){return Y(t).forEach(function(n){var r=e[n]||(e[n]=new ge);on(r,t[n])}),e}function Hi(e){return new ka(function(t){var n=ar(e);function r(_){n&&it();var p=function(){return Re(e,{subscr:_,trans:null})},y=D.trans?ot(D.transless,p):p();return n&&y.then(Ce,Ce),y}var i=!1,o={},s={},a={get closed(){return i},unsubscribe:function(){i=!0,Ke.storagemutated.unsubscribe(f)}};t.start&&t.start(a);var u=!1,l=!1;function c(){return Y(s).some(function(_){return o[_]&&Sa(o[_],s[_])})}var f=function(_){Vi(o,_),c()&&d()},d=function(){if(!(u||i)){o={};var _={},p=r(_);l||(Ke(wt,f),l=!0),u=!0,Promise.resolve(p).then(function(y){u=!1,!i&&(c()?d():(o={},s=_,t.next&&t.next(y)))},function(y){u=!1,t.error&&t.error(y),a.unsubscribe()})}};return d(),a})}var Xn;try{Xn={indexedDB:U.indexedDB||U.mozIndexedDB||U.webkitIndexedDB||U.msIndexedDB,IDBKeyRange:U.IDBKeyRange||U.webkitIDBKeyRange}}catch{Xn={indexedDB:null,IDBKeyRange:null}}var Me=xr;tt(Me,O(O({},fn),{delete:function(e){var t=new Me(e,{addons:[]});return t.delete()},exists:function(e){return new Me(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return fa(Me.dependencies).then(e)}catch{return X(new T.MissingAPI)}},defineClass:function(){function e(t){ne(this,t)}return e},ignoreTransaction:function(e){return D.trans?ot(D.transless,e):e()},vip:zn,async:function(e){return function(){try{var t=qn(e.apply(this,arguments));return!t||typeof t.then!="function"?k.resolve(t):t}catch(n){return X(n)}}},spawn:function(e,t,n){try{var r=qn(e.apply(n,t||[]));return!r||typeof r.then!="function"?k.resolve(r):r}catch(i){return X(i)}},currentTransaction:{get:function(){return D.trans||null}},waitFor:function(e,t){var n=k.resolve(typeof e=="function"?Me.ignoreTransaction(e):e).timeout(t||6e4);return D.trans?D.trans.waitFor(n):n},Promise:k,debug:{get:function(){return ye},set:function(e){_i(e,e==="dexie"?function(){return!0}:Oi)}},derive:nt,extend:ne,props:tt,override:vi,Events:Pt,on:Ke,liveQuery:Hi,extendObservabilitySet:Vi,getByKeyPath:xe,setByKeyPath:ce,delByKeyPath:ss,shallowClone:gi,deepClone:At,getObjectDiff:br,cmp:te,asap:yi,minKey:Fn,addons:[],connections:dt,errnames:lr,dependencies:Xn,semVer:$r,version:$r.split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,n*2)})}));Me.maxKey=bt(Me.dependencies.IDBKeyRange);typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Ke(wt,function(e){if(!be){var t;dn?(t=document.createEvent("CustomEvent"),t.initCustomEvent(Pe,!0,!0,e)):t=new CustomEvent(Pe,{detail:e}),be=!0,dispatchEvent(t),be=!1}}),addEventListener(Pe,function(e){var t=e.detail;be||sn(t)}));function sn(e){var t=be;try{be=!0,Ke.storagemutated.fire(e)}finally{be=t}}var be=!1;if(typeof BroadcastChannel<"u"){var jr=new BroadcastChannel(Pe);Ke(wt,function(e){be||jr.postMessage(e)}),jr.onmessage=function(e){e.data&&sn(e.data)}}else if(typeof self<"u"&&typeof navigator<"u"){Ke(wt,function(e){try{be||(typeof localStorage<"u"&&localStorage.setItem(Pe,JSON.stringify({trig:Math.random(),changedParts:e})),typeof self.clients=="object"&&An([],self.clients.matchAll({includeUncontrolled:!0}),!0).forEach(function(t){return t.postMessage({type:Pe,changedParts:e})}))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",function(e){if(e.key===Pe){var t=JSON.parse(e.newValue);t&&sn(t.changedParts)}});var Wr=self.document&&navigator.serviceWorker;Wr&&Wr.addEventListener("message",Ia)}function Ia(e){var t=e.data;t&&t.type===Pe&&sn(t.changedParts)}k.rejectionMapper=vs;_i(ye,Oi);class Da extends xr{decks;words;wordConnections;constructor(){super("vocabulary"),this.version(1).stores({decks:"++id, name",words:"++id, word, deckId, [deckId+isDraft]",wordConnections:"++id, wordId, connectionWordId"})}}const M=new Da,Te=e=>{const[t,n]=G(),i=Hi(e).subscribe(o=>{n(()=>o)});return St(()=>{i.unsubscribe()}),t};const Pa=q('<main><h1>Home</h1><ul aria-label="List of decks" class="deck-list"></ul></main>'),Ta=q("<li></li>"),Ra=()=>{const e=Te(async()=>await M.decks.toArray());return(()=>{const t=Pa.cloneNode(!0),n=t.firstChild,r=n.nextSibling;return B(r,R(ir,{get each(){return e()},children:i=>(()=>{const o=Ta.cloneNode(!0);return B(o,R(Se,{class:"deck-card",get href(){return`/deck/${i.id?.toString()}`},get children(){return i.name}})),o})()})),B(t,R(Se,{class:"button",href:"/create-deck",children:"Create deck"}),null),t})()},$a=q('<main><h1>Create Deck</h1><form><label for="input-create-deck-name">Name</label><input class="input" id="input-create-deck-name"><button class="button">Create</button></form></main>'),Ka=()=>{let e;const t=or(),n=r=>{r.preventDefault(),M.decks.add({name:e.value}).then(()=>t("/")).catch(console.error)};return(()=>{const r=$a.cloneNode(!0),i=r.firstChild,o=i.nextSibling,s=o.firstChild,a=s.nextSibling;o.addEventListener("submit",n);const u=e;return typeof u=="function"?Fe(u,a):e=a,r})()};function pn(e){if(e===null||e===!0||e===!1)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function Ae(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function zt(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?zt=function(n){return typeof n}:zt=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},zt(e)}function xt(e){Ae(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||zt(e)==="object"&&t==="[object Date]"?new Date(e.getTime()):typeof e=="number"||t==="[object Number]"?new Date(e):((typeof e=="string"||t==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function Oa(e,t){Ae(2,arguments);var n=xt(e),r=pn(t);return isNaN(r)?new Date(NaN):(r&&n.setDate(n.getDate()+r),n)}function zi(e,t){Ae(2,arguments);var n=xt(e).getTime(),r=pn(t);return new Date(n+r)}var Ba=36e5;function Ma(e,t){Ae(2,arguments);var n=pn(t);return zi(e,n*Ba)}function Gn(e){Ae(1,arguments);var t=xt(e);return t.setHours(0,0,0,0),t}var La=6e4;function Na(e,t){Ae(2,arguments);var n=pn(t);return zi(e,n*La)}function Fa(e,t){Ae(2,arguments);var n=Gn(e),r=Gn(t);return n.getTime()===r.getTime()}function qi(e,t){Ae(2,arguments);var n=xt(e),r=xt(t);return n.getTime()<r.getTime()}function ja(e){return Ae(1,arguments),Fa(e,Date.now())}const Wa=q('<main><h1></h1><h2>Word count: <!> | Due: </h2><div class="deck-actions"></div></main>'),Ua=()=>{const{id:e}=ln(),t=parseInt(e,10),n=Te(async()=>await M.decks.get(parseInt(e,10))),r=Te(async()=>await M.words.where({deckId:t,isDraft:0}).count()),i=Te(async()=>await M.words.where({deckId:t,isDraft:0}).and(o=>qi(o.dueDate,new Date)).count());return(()=>{const o=Wa.cloneNode(!0),s=o.firstChild,a=s.nextSibling,u=a.firstChild,l=u.nextSibling;l.nextSibling;const c=a.nextSibling;return B(s,()=>n()?.name),B(a,r,l),B(a,i,null),B(c,R(Se,{class:"button",href:`/deck/${e}/add-word`,children:"Add word"}),null),B(c,R(Se,{class:"button success",href:`/deck/${e}/study`,children:"Study"}),null),o})()},Va=30,Qn=.5,Ha=e=>{let t=0;return()=>`${e??""}-${++t}`},za=()=>{let e=0;return()=>++e};const qa=q('<span class="combobox-container"><input class="input"><ul class="combobox-list" role="listbox"></ul></span>'),Ya=q('<li class="combobox-list-item" role="option"></li>'),Xa=Ha("combobox"),Ga=e=>{let t,n;const[r,i]=G(),[o,s]=G(!1),a=Xa(),u=()=>e.id??`${a}-input`,l=v=>{t.contains(v.target)||s(!1)};document.addEventListener("pointerup",l),St(()=>{document.removeEventListener("pointerup",l)});const c=v=>e.onInput!=null?e.onInput(v):void 0,f=v=>{const h=r(),g=h!=null,w=n.querySelectorAll("li");if(w.length===0)return;const b=g&&(v===1&&h.index>=w.length-1||v===-1&&h.index===0)||!g?v===1?0:w.length-1:h.index+v;w[b].classList.add("highlight"),w[h?.index]?.classList?.remove("highlight");const C=e.suggestions[b];i({index:b,id:C.id})},d=v=>{const h=v.target;switch(v.key){case"Enter":{if(e.onEnter==null)return;const g=r();let m=g!=null?e.suggestions[g.index]:void 0;const b=m!=null?m.label:h.value;m==null&&(m=e.suggestions.find(C=>C.label===b)),e.onEnter(Object.assign(v,{label:b,fromSuggestionList:m!=null,id:m?.id})),h.value="",s(!1);break}case"ArrowUp":case"ArrowDown":{if(e.suggestions.length===0)return;v.preventDefault(),s(!0),v.altKey||f(v.key==="ArrowUp"?-1:1);return}case"Escape":case"Tab":{s(!1);break}default:s(!0)}i()},_=()=>{s(!0)},p=`${a}-suggestion-list`,y=v=>`${a}-suggestion-id-${JSON.stringify(v)}`,S=(v,h)=>{if(e.onEnter==null)return;const g=document.getElementById(u()),w=e.suggestions.find(m=>m.id===v);w!=null&&(e.onEnter(Object.assign(h,{label:w.label,fromSuggestionList:!0,id:v})),g.value="",s(!1))};return(()=>{const v=qa.cloneNode(!0),h=v.firstChild,g=h.nextSibling,w=t;typeof w=="function"?Fe(w,v):t=v,h.addEventListener("focus",_),h.$$keydown=d,h.$$input=c;const m=e.ref;typeof m=="function"?Fe(m,h):e.ref=h,he(h,"aria-controls",p);const b=n;return typeof b=="function"?Fe(b,g):n=g,he(g,"id",p),B(g,R(ir,{get each(){return e.suggestions},children:C=>(()=>{const A=Ya.cloneNode(!0);return A.$$click=x=>S(C.id,x),B(A,()=>C.label),oe(x=>{const E=y(C.id),I=r()?.id===C.id;return E!==x._v$6&&he(A,"id",x._v$6=E),I!==x._v$7&&he(A,"aria-selected",x._v$7=I),x},{_v$6:void 0,_v$7:void 0}),A})()})),oe(C=>{const A=u(),x=o()&&e.suggestions.length>0,E=r()!=null?y(r()?.id):void 0,I=!!o(),K=e.listLabel;return A!==C._v$&&he(h,"id",C._v$=A),x!==C._v$2&&he(h,"aria-expanded",C._v$2=x),E!==C._v$3&&he(h,"aria-activedescendent",C._v$3=E),I!==C._v$4&&g.classList.toggle("display",C._v$4=I),K!==C._v$5&&he(g,"aria-label",C._v$5=K),C},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0}),v})()};ze(["input","keydown","click"]);const Qa=q('<form><label for="input-word-text">Word / Phrase</label><input class="input" id="input-word-text"><label for="input-word-meaning">Meaning</label><input class="input" id="input-word-meaning"><label for="input-word-context">Context</label><input class="input" id="input-word-context"><label for="input-word-new-connection">Add connection</label><div class="input-word-new-connection-container"><button class="button" type="button">+</button></div><ul aria-live="polite"></ul><button class="button"></button></form>'),Ja=q('<li><div class="connection-indicator button narrow"><button>\u2613</button></div></li>'),Ur=za();let Vr;const Za=150,Yi=e=>{let t,n,r,i;const[o,s]=G(e.defaultData?.connections??[]);Zi(()=>{e.defaultData?.connections!=null&&s(e.defaultData?.connections)});const a=v=>{v.preventDefault(),e.onSubmit({word:t.value,meaning:n.value,context:r.value,connections:o()}),e.resetForm===!0&&(t.value="",n.value="",r.value="",s([]))},u=Te(async()=>(await M.words.where("deckId").equals(e.deckId).toArray()).map(v=>({id:v.id,word:v.word}))),[l,c]=G(),f=F(()=>{const v=l();if(v!=null)return u()?.filter(h=>h.word.toLowerCase().match(v.toLowerCase())!=null).map(h=>({label:h.word,id:h.id}))}),d=v=>v==null?"":v.toString(),_=v=>{v.preventDefault(),s(h=>[...h,{word:v.label,wordId:v.id??Ur(),isExisting:v.fromSuggestionList}])},p=()=>{const v=i?.value;if(v==="")return;const h=u()?.find(g=>g.word===v);s(g=>[...g,{word:h?.word??i.value,wordId:h?.id??Ur(),isExisting:h!=null}])},y=v=>{const h=v.target;clearTimeout(Vr),Vr=window.setTimeout(()=>{c(h.value===""?void 0:h.value)},Za)},S=v=>()=>{s(h=>h.filter(g=>g.wordId!==v))};return(()=>{const v=Qa.cloneNode(!0),h=v.firstChild,g=h.nextSibling,w=g.nextSibling,m=w.nextSibling,b=m.nextSibling,C=b.nextSibling,A=C.nextSibling,x=A.nextSibling,E=x.firstChild,I=x.nextSibling,K=I.nextSibling;v.addEventListener("submit",a);const $=t;typeof $=="function"?Fe($,g):t=g;const N=n;typeof N=="function"?Fe(N,m):n=m;const P=r;return typeof P=="function"?Fe(P,C):r=C,B(x,R(Ga,{id:"input-word-new-connection",ref(j){const H=i;typeof H=="function"?H(j):i=j},get suggestions(){return f()??[]},listLabel:"Previous words you have saved",onInput:y,onEnter:_}),E),E.$$click=p,B(I,R(ir,{get each(){return o()},children:j=>(()=>{const H=Ja.cloneNode(!0),Q=H.firstChild,re=Q.firstChild;return B(Q,()=>j.word,re),oi(re,"click",S(j.wordId),!0),H})()})),B(K,()=>e.submitText),oe(()=>g.value=d(e.defaultData?.word)),oe(()=>m.value=d(e.defaultData?.meaning)),oe(()=>C.value=d(e.defaultData?.context)),v})()};ze(["click"]);const eu=q('<main><div class="added-words"></div><h1>Add Word</h1></main>'),tu=()=>{const{id:e}=ln(),t=parseInt(e,10),[n,r]=G([]),i=o=>{M.transaction("rw",M.words,M.wordConnections,async()=>{const s=await Promise.all(o.connections.filter(c=>!c.isExisting).map(async c=>await M.words.add({word:c.word,meaning:"",context:"",dueDate:new Date,deckId:t,isDraft:1,nextIntervalDays:Qn}))),a=o.connections.filter(c=>c.isExisting).map(c=>c.wordId),u=[...s,...a],l=await M.words.add({word:o.word,meaning:o.meaning,context:o.context,dueDate:Na(new Date,Va),deckId:t,isDraft:0,nextIntervalDays:Qn});await Promise.all(u.map(async c=>await M.wordConnections.add({wordId:l,connectionWordId:c})))}).then(()=>{r(s=>[o.word,...s])}).catch(console.error)};return(()=>{const o=eu.cloneNode(!0),s=o.firstChild;return s.nextSibling,B(o,R(Se,{class:"button narrow",href:`/deck/${t}`,children:"Back to Deck"}),s),B(s,R(ue,{get when(){return n().length>0},get children(){return["Just added: ",F(()=>n().join(", "))]}})),B(o,R(Yi,{deckId:t,onSubmit:i,submitText:"Add",resetForm:!0}),null),o})()},nu="modulepreload",ru=function(e){return"/vocab-trainer/"+e},Hr={},iu=function(t,n,r){if(!n||n.length===0)return t();const i=document.getElementsByTagName("link");return Promise.all(n.map(o=>{if(o=ru(o),o in Hr)return;Hr[o]=!0;const s=o.endsWith(".css"),a=s?'[rel="stylesheet"]':"";if(!!r)for(let c=i.length-1;c>=0;c--){const f=i[c];if(f.href===o&&(!s||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${a}`))return;const l=document.createElement("link");if(l.rel=s?"stylesheet":nu,s||(l.as="script",l.crossOrigin=""),l.href=o,document.head.appendChild(l),s)return new Promise((c,f)=>{l.addEventListener("load",c),l.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t())};function ou(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:i,onRegisteredSW:o,onRegisterError:s}=e;let a,u,l,c;const f=async(_=!0)=>{await l,_&&a?.addEventListener("controlling",p=>{p.isUpdate&&window.location.reload()}),await c?.()};async function d(){if("serviceWorker"in navigator){const{Workbox:_,messageSW:p}=await iu(()=>import("./workbox-window.prod.es5.d2780aeb.js"),[]);c=async()=>{u&&u.waiting&&await p(u.waiting,{type:"SKIP_WAITING"})},a=new _("/vocab-trainer/sw.js",{scope:"/vocab-trainer/",type:"classic"}),a.addEventListener("activated",y=>{y.isUpdate||r?.()});{const y=()=>{n?.()};a.addEventListener("waiting",y),a.addEventListener("externalwaiting",y)}a.register({immediate:t}).then(y=>{u=y,o?o("/vocab-trainer/sw.js",y):i?.(y)}).catch(y=>{s?.(y)})}}return l=d(),f}function su(e={}){const{immediate:t=!0,onNeedRefresh:n,onOfflineReady:r,onRegistered:i,onRegisteredSW:o,onRegisterError:s}=e,[a,u]=G(!1),[l,c]=G(!1),f=ou({immediate:t,onOfflineReady(){c(!0),r?.()},onNeedRefresh(){u(!0),n?.()},onRegistered:i,onRegisteredSW:o,onRegisterError:s});return{needRefresh:[a,u],offlineReady:[l,c],updateServiceWorker:f}}const au=q('<main><h1>Settings</h1><div class="settings"><button class="button">Delete data</button><button class="button">Update</button></div></main>'),uu=()=>{const e=()=>{M.delete().then(async()=>await M.open()).catch(console.error)},t=su();return(()=>{const n=au.cloneNode(!0),r=n.firstChild,i=r.nextSibling,o=i.firstChild,s=o.nextSibling;return o.$$click=e,s.$$click=()=>t?.updateServiceWorker(),n})()};ze(["click"]);const zr=q('<div class="card"></div>'),lu=q('<div class="actions"><button class="button failure">Forgotton</button><button class="button success">Remembered</button></div>'),qr=q('<p class="answer"></p>'),cu=q('<div class="actions"><button class="button failure">Incorrect</button><button class="button success">Correct</button></div>'),fu=q("<p>Finished</p>"),du=q("<p>No words to study currently</p>"),hu=q('<main><div class="header"><h1>Study </h1></div></main>'),pu=q(`<div class="actions"><button class="button failure">Still can't recall</button><button class="button success">Remembered with context</button></div>`),vu=q('<div class="actions"><button class="button failure">Continue</button></div>'),yu=()=>{const{id:e}=ln(),[{word:t}]=fi(),n=parseInt(t,10),r=parseInt(e,10),i=Te(async()=>await M.decks.get(r)),[o,s]=G(),[a,u]=G(),[l,c]=G();M.words.where({deckId:r,isDraft:0}).and(b=>qi(b.dueDate,new Date)).toArray().then(b=>{const C=b.reduce((x,E)=>(x[E.id]={word:E,reviewed:!1},x),{});s(C),t!=null&&t!==""&&C[parseInt(t,10)]!=null&&u(C[n].word),u(f(C))}).catch(console.error);const f=b=>{const C=Object.values(b).filter(x=>!x.reviewed);if(C.length===0)return;const A=Math.floor(Math.random()*C.length);return C[A].word},d=()=>{c({userSaidTheyRememberedCorrectly:!0})},_=()=>{c({userSaidTheyRememberedCorrectly:!1})},p=()=>{c({userSaidTheyRememberedCorrectly:!0,requiredContext:!0})},y=()=>{c({userSaidTheyRememberedCorrectly:!1,forgotWithContext:!0})},S=()=>{const b=l()?.requiredContext===!0;h(b?1.1:2)},v=()=>{h(1)},h=b=>{const C=a(),A=C.nextIntervalDays,x=new Date;let E;E=A<1?Ma(x,A*24):Oa(x,A),ja(E)||(E=Gn(E)),M.words.update(C.id,{dueDate:E,nextIntervalDays:A*b}).catch(console.error);const I=o();I[C.id].reviewed=!0,s(I),u(f(I)),c(void 0)},g=b=>b==null?!0:Object.values(b).length>0,w=()=>{if(l()?.forgotWithContext===!0)return!1;const b=a();return b?.context!=null&&b.context!==""},m=b=>`/edit-word/${b}?returnTo=/deck/${r}/study?word=${b}`;return(()=>{const b=hu.cloneNode(!0),C=b.firstChild,A=C.firstChild;return A.firstChild,B(A,()=>i()?.name,null),B(C,R(ue,{get when(){return a()},get children(){return R(Se,{class:"button narrow",get href(){return m(a()?.id)},children:"Edit"})}}),null),B(b,R(ue,{get when(){return a()},get children(){return[(()=>{const x=zr.cloneNode(!0);return B(x,()=>a()?.word),x})(),R(ue,{get when(){return l()==null},get children(){const x=lu.cloneNode(!0),E=x.firstChild,I=E.nextSibling;return E.$$click=_,I.$$click=d,x}}),R(ue,{get when(){return l()!=null},get children(){return[R(ue,{get when(){return!l()?.userSaidTheyRememberedCorrectly},get children(){return[F(()=>F(()=>!!w())()&&[(()=>{const x=zr.cloneNode(!0);return B(x,()=>a()?.context),x})(),(()=>{const x=pu.cloneNode(!0),E=x.firstChild,I=E.nextSibling;return E.$$click=y,I.$$click=p,x})()]),F(()=>F(()=>!w())()&&[(()=>{const x=qr.cloneNode(!0);return B(x,()=>a()?.meaning),x})(),(()=>{const x=vu.cloneNode(!0),E=x.firstChild;return E.$$click=v,x})()])]}}),R(ue,{get when(){return l()?.userSaidTheyRememberedCorrectly},get children(){return[(()=>{const x=qr.cloneNode(!0);return B(x,()=>a()?.meaning),x})(),(()=>{const x=cu.cloneNode(!0),E=x.firstChild,I=E.nextSibling;return E.$$click=v,I.$$click=S,x})()]}})]}})]}}),null),B(b,R(ue,{get when(){return F(()=>a()==null)()&&g(o())},get children(){return fu.cloneNode(!0)}}),null),B(b,R(ue,{get when(){return F(()=>o()!=null)()&&!g(o())},get children(){return du.cloneNode(!0)}}),null),b})()};ze(["click"]);const mu=async(e,t)=>await M.words.add({word:e,meaning:"",context:"",dueDate:new Date,isDraft:1,deckId:t,nextIntervalDays:Qn});const gu=q('<main><div class="header"><h1>Edit</h1></div></main>'),wu=()=>{const{id:e}=ln(),[{returnTo:t}]=fi(),n=parseInt(e,10),r=or(),i=t??"/",o=Te(async()=>await M.words.get(n)),s=Te(async()=>{const l=await M.wordConnections.where({wordId:n}).toArray();return(await M.words.where("id").anyOf(l.map(c=>c.connectionWordId)).toArray()).map(c=>({word:c.word,wordId:c.id,isExisting:!0}))}),a=l=>{M.transaction("rw",M.words,M.wordConnections,async()=>{const c=await Promise.all(l.connections.filter(h=>!h.isExisting).map(async h=>await mu(h.word,o()?.deckId))),f=l.connections.filter(h=>h.isExisting).map(h=>h.wordId),d=new Set([...c,...f]),_=s()?.filter(h=>!d.has(h.wordId)).map(h=>h.wordId),p=new Set(s()?.map(h=>h.wordId)),y=[...c,...f].filter(h=>!p.has(h)),S=Promise.all(_?.map(async h=>{await M.wordConnections.where({wordId:n,connectionWordId:h}).delete()})??[]),v=Promise.all(y.map(async h=>await M.wordConnections.add({wordId:n,connectionWordId:h})));await Promise.all([S,v]),await M.words.update(n,l)}).then(()=>r(i)).catch(console.error)},u=()=>{const l=o();return{word:l?.word,meaning:l?.meaning,context:l?.context,connections:s()}};return(()=>{const l=gu.cloneNode(!0),c=l.firstChild;return c.firstChild,B(c,R(Se,{class:"button",href:i,children:"Back"}),null),B(l,R(ue,{get when(){return o()},get children(){return R(Yi,{onSubmit:a,get deckId(){return o()?.deckId},submitText:"Update",get defaultData(){return u()}})}}),null),l})()},bu=q('<div><header><nav></nav><button class="color-mode-switcher"></button></header><div class="outlet"></div></div>'),_u=()=>{const e=window.matchMedia("(prefers-color-scheme: light)").matches,[t,n]=G(e);window.matchMedia("(prefers-color-scheme: light)").addEventListener("change",i=>{document.documentElement.removeAttribute("class"),n(i.matches)});const r=()=>{const i=t()?"dark-mode":"light-mode";document.documentElement.classList.contains(i)?document.documentElement.classList.remove(i):document.documentElement.classList.add(i)};return(()=>{const i=bu.cloneNode(!0),o=i.firstChild,s=o.firstChild,a=s.nextSibling,u=o.nextSibling;return B(s,R(Se,{href:"/",children:"Home"}),null),B(s,R(Se,{href:"/settings",children:"Settings"}),null),a.$$click=r,B(a,()=>t()?"Dark mode":"Light mode"),B(u,R(es,{get children(){return[R(Be,{path:"/",element:Ra}),R(Be,{path:"/settings",element:uu}),R(Be,{path:"/deck/:id",element:Ua}),R(Be,{path:"/deck/:id/add-word",element:tu}),R(Be,{path:"/deck/:id/study",element:yu}),R(Be,{path:"/edit-word/:id",element:wu}),R(Be,{path:"/create-deck",element:Ka})]}})),i})()};ze(["click"]);wo(()=>R(Zo,{get base(){return"/vocab-trainer/"},get children(){return R(_u,{})}}),document.getElementById("root"));
